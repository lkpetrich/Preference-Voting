(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    157654,       4119]
NotebookOptionsPosition[    143643,       3822]
NotebookOutlinePosition[    143997,       3838]
CellTagsIndexPosition[    143954,       3835]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Preference-Voting Algorithms

They work with ballot object of the form
List of:
{weight, {candidates in order of preference}}

The preference ordering of candidates need not include all of them in a ballot

Setup:
GetCandidates[ballots] -- returns which candidates, in sorted order
RemoveEmptyBallots[ballots] -- necessary in some parts
\[LineSeparator]What they return: {} = list, {{}} = list of lists, C = \
candidate, CN = candidate + numerical value (count, etc.)

Overall, Top Number:
TotalCount[ballots] -- returns the total count of votes (sum of weights)
AllVotes[ballots] -- returns each candidate\[CloseCurlyQuote]s total count of \
votes -- {CN}
TopOne[ballots] -- top one: first past the post, plurality voting -- {CN}
TopNum[ballots,num] -- Bucklin voting: top (num) -- {CN}
TopNumList[ballots] -- list of Bucklin-voting results for each possible \
number -- {{CN}}
MinusBottom[ballots] -- like top one, but counts up unselected or last \
selected candidates  -- {CN}

Rank Counting:
Borda[ballots] -- Borda count -- {CN}
ModBorda[ballots] -- each ballot is counted down from its length instead of \
the overall number of candidates -- {CN}
CumulBorda[ballots] -- simulates cumulative voting by dividing each ballot\
\[CloseCurlyQuote]s modified-Borda values by those values\[CloseCurlyQuote] \
sum -- {CN}
MajorityJudgment[ballots] -- finds weighted medians of the ranks of the \
candidates -- {CN}

Multistep:
TopTwoRunoff[ballots,DoRound=TopOne] -- the top two candidates are selected \
out, then go head-to-head
- DoRound: how to count each round -- {CN}
SequentialRunoff[ballots,ThresholdFunc=Min,DoRound=TopOne] -- the \
below-threshold candidates are dropped, then the process is repeated until \
one cannot proceed further -- {{CN}}
- ThresholdFunc: how to find the maximum numerical value to reject
- DoRound: how to count each round -- {CN}

SingleTransferableVote[ballots,num] -- tries to fill (num) seats. Returns \
list of {round results, + for accepted, - for rejected, accepted or rejected \
candidate in this round}, then a list of winners
CompPairOutcomesSTV[ballots,num] -- Comparison of Pairs of Outcomes for STV: \
returns {size-(num) subsets of the candidates, matrix of how each subset \
scores against each other subset}
One uses a Condorcet method to proceed further, like in
CPOSTVSchulze[ballots,num]

Condorcet Setup:
CondorcetMatrix[ballots] -- as it says, indexed by candidate index
Has these auxiliary functions:
ApplyPermutations[n,f,data] --
- n = length of all permutations, generated in lexical order
- f = function that takes (permutation,data) and returns an updated version \
of data
- data = initial value
- Returns final version of data
permcycles[perm] -- returns all the cyclic permutations in perm

Condorcet Methods:
CondorcetWinnerIndex[prefmat] -- takes a Condorcet matrix and returns the \
winner\[CloseCurlyQuote]s index, or None if there is no Condorcet winner
CondorcetWinner[ballots] -- returns {True,Condorcet Winner} or else {False} \
if there is none
Schulze[ballots] -- Schulze beathpath -- {C}
Copeland[ballots] -- Copeland pairwise aggregation -- {CN}
Minimax[ballots,which] -- Minimax -- {CN}
- (which) is: \[OpenCurlyDoubleQuote]wins\[CloseCurlyDoubleQuote] = winning \
votes, \[OpenCurlyDoubleQuote]marg\[CloseCurlyDoubleQuote] = margins, \
\[OpenCurlyDoubleQuote]oppo\[CloseCurlyDoubleQuote] = pairwise opposition
KemenyYoung[ballots] -- Kemeny-Young -- {C}
Dodgson[ballots] -- Dodgson\[CloseCurlyQuote]s method -- {CN} where the N is \
the smallest permutation distance that makes the candidate a Condorcet \
winner. That distance is (length of permutation) - (number of cycles), and is \
0 for ascending order. For no Condorcet winner, (length of permutation) is used
RankedPairs[ballots] -- Tideman\[CloseCurlyQuote]s ranked pairs -- {C}
MaximalLotteries[ballots] -- finds a probabilistic extension of Condorcet \
winners -- {CN}

Maximal Sets:
MaximalSet[ballots,type] -- for type \[OpenCurlyDoubleQuote]Schwartz\
\[CloseCurlyDoubleQuote], returns the Schwartz one (>), for type \
\[OpenCurlyDoubleQuote]Smith\[CloseCurlyDoubleQuote], returns the Smith one \
(>=) -- {C}
MaximalSetSequence[ballots,type] -- makes a sequence of maximal sets by \
removing them from the ballots as it goes -- {{C}}

Alternate Algorithms: my original versions of the permutation-cycles and the \
acyclicity-tester. They are superseded here by Mathematica functions, and \
they are included for reference when constructing other-language versions.

However, alternate versions of the linear-programming solver are not included \
here.\
\>", "Text",ExpressionUUID->"64293c62-2ca8-49b6-a810-e2f63403724e"],

Cell[CellGroupData[{

Cell["Algorithms", "Section",ExpressionUUID->"3d6fca68-9461-4201-9be8-3332935eee5e"],

Cell[CellGroupData[{

Cell["Setup", "Subsection",ExpressionUUID->"35b05ba1-a8c4-466b-9a55-a1370866193e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeighted", "[", 
   RowBox[{"ballots_", ",", 
    RowBox[{"wt_:", "1"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wt", ",", "#"}], "}"}], "&"}], " ", "/@", " ", 
   "ballots"}]}]], "Input",ExpressionUUID->"eba25053-4493-4992-9a24-\
2390118e4cce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeBallotsFromCandNums", "[", "cns_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cands", ",", "nums", ",", "n", ",", "num", ",", "wt", ",", "pns", ",", 
      "prefs", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cands", ",", "nums"}], "}"}], " ", "=", " ", "cns"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "cands", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wt", ",", "pns"}], "}"}], " ", "=", " ", "num"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"prefs", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"Null", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"prefs", "[", 
            RowBox[{"[", 
             RowBox[{"pns", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{"cands", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"wt", ",", "prefs"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"num", ",", "nums"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"55ae3829-c316-\
4f75-b8fb-64adba884990"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCandidates", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Union", "  ", "@@", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", "ballots"}], 
    ")"}]}]}]], "Input",ExpressionUUID->"de13a307-a609-404a-805f-\
920ae45f1086"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveEmptyBallots", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{"ballots", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "0"}], "&"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"aa387e86-13ab-44bb-aab2-45430209335f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lstoix", "[", 
   RowBox[{"lst_", ",", "lix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"lix", "[", 
      RowBox[{"lst", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "=", " ", "k"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"Length", "[", "lst", "]"}]}], "}"}]}], "]"}]}]], "Input",Expres\
sionUUID->"4814d37b-b88b-480f-ba03-e925e9ca52ff"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Ballot", " ", 
   RowBox[{"processing", ".", "\[IndentingNewLine]", "Removes"}], " ", 
   "empty", " ", 
   RowBox[{"ballots", ".", "\[IndentingNewLine]", "Function"}], " ", 
   RowBox[{"arg", ":", " ", 
    RowBox[{"ballot", " ", 
     RowBox[{"member", ".", " ", "Returns"}], " ", "whether", " ", "or", " ", 
     "not", " ", "to", " ", "keep", " ", "the", " ", 
     RowBox[{"member", "."}]}]}]}], " ", "*)"}]], "Input",ExpressionUUID->\
"cb971d4a-3f1e-450d-b457-3f7e87f7b7c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessBallots", "[", 
   RowBox[{"ballots_", ",", " ", "procfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ballot", ",", "wt", ",", "prefs", ",", "newballots"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newballots", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"wt", ",", "prefs"}], "}"}], " ", "=", " ", "ballot"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"prefs", " ", "=", " ", 
          RowBox[{"Pick", "[", 
           RowBox[{"prefs", ",", " ", 
            RowBox[{"procfunc", " ", "/@", " ", "prefs"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"wt", ",", "prefs"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"ballot", ",", "ballots"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RemoveEmptyBallots", "[", "newballots", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"cd543992-2901-\
46b9-a225-2c6ad00a6817"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Args", ":", " ", "ballots"}], ",", " ", 
   RowBox[{
   "candidates", " ", "to", " ", "either", " ", "keep", " ", "or", " ", 
    "remove"}]}], " ", "*)"}]], "Input",ExpressionUUID->"4305e25f-4a0c-4969-\
a9fd-8fc43b20390d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KeepCandidates", "[", 
   RowBox[{"ballots_", ",", "cands_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ProcessBallots", "[", 
   RowBox[{"ballots", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"cands", ",", "#"}], "]"}], ")"}], "&"}]}], "]"}]}]], "Input",E\
xpressionUUID->"2545e4fc-2dc5-4dac-9066-b56f2395af57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveCandidates", "[", 
   RowBox[{"ballots_", ",", "cands_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ProcessBallots", "[", 
   RowBox[{"ballots", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"cands", ",", "#"}], "]"}]}], ")"}], "&"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"1f28f70e-06c1-494b-a462-1f72e00c182c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Generic", " ", "counting", " ", 
    RowBox[{"function", ".", "\[IndentingNewLine]", "Function"}], " ", 
    "countfunc", " ", "accepts", " ", 
    RowBox[{
    "args", ":", "\[IndentingNewLine]", "Counts", ":", " ", "arg", ":", " ", 
     "candidate"}]}], ",", " ", 
   RowBox[{"returns", ":", " ", "number"}], ",", " ", "Weight", ",", " ", 
   "Preferences", ",", " ", 
   RowBox[{"Cands", " ", 
    RowBox[{"(", 
     RowBox[{"list", " ", "of", " ", "candidates"}], ")"}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",ExpressionUUID->"0bd4623c-f695-468b-\
8817-c6357895b093"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots_", ",", "countfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cands", ",", "cand", ",", "counts", ",", "ballot", ",", " ", "wt", ",", 
      " ", "prefs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"counts", "[", "cand", "]"}], " ", "=", " ", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"cand", ",", "cands"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wt", ",", "prefs"}], "}"}], " ", "=", " ", "ballot"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"countfunc", "[", 
         RowBox[{"counts", ",", "wt", ",", "prefs", ",", "cands"}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ballot", ",", "ballots"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"counts", "[", "#", "]"}]}], "}"}], "&"}], " ", "/@", " ", 
        "cands"}], ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"42e05fca-add4-\
4467-a8bd-563498e2e203"]
}, Closed]],

Cell[CellGroupData[{

Cell["Overall, Top Number", "Subsection",ExpressionUUID->"2eee5617-0da6-4be9-b6fd-aff3175d4457"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalCount", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "ballots"}], 
   "]"}]}]], "Input",ExpressionUUID->"3aa66cbc-ad12-4795-a1fd-e8bdf0d3f698"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllVotesFunction", "[", 
   RowBox[{"counts_", ",", "wt_", ",", "prefs_", ",", "cands_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"counts", "[", "pref", "]"}], " ", "+=", "wt"}], ",", 
    RowBox[{"{", 
     RowBox[{"pref", ",", "prefs"}], "}"}]}], "]"}]}]], "Input",ExpressionUUID\
->"6b1f814b-cb80-4d47-abc9-862ca5353b09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllVotes", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", "AllVotesFunction"}], "]"}]}]], "Input",ExpressionU\
UID->"d47983e3-daa4-42f5-87c1-7bbcf1c654f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TopOneFunction", "[", 
   RowBox[{"counts_", ",", "wt_", ",", "prefs_", ",", "cands_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "prefs", "]"}], " ", ">", " ", "0"}], ",", 
    RowBox[{
     RowBox[{"counts", "[", 
      RowBox[{"First", "[", "prefs", "]"}], "]"}], " ", "+=", " ", "wt"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"b0389a42-af81-4e8e-9ce9-7924f55fdc0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TopOne", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", "TopOneFunction"}], "]"}]}]], "Input",ExpressionUUI\
D->"94c937cd-ebf9-4e31-89e6-b0df25137521"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinusBottomFunction", "[", 
   RowBox[{"counts_", ",", "wt_", ",", "prefs_", ",", "cands_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"unselected", ",", "pref"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"unselected", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"cands", ",", "prefs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "unselected", "]"}], " ", ">", " ", "0"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"counts", "[", "pref", "]"}], " ", "-=", " ", "wt"}], ",", 
         RowBox[{"{", 
          RowBox[{"pref", ",", "unselected"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "prefs", "]"}], " ", ">", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"counts", "[", 
           RowBox[{"Last", "[", "prefs", "]"}], "]"}], " ", "-=", " ", 
          "wt"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"e5be9a85-3e40-\
4463-816f-71351dfdce98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinusBottom", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", "MinusBottomFunction"}], "]"}]}]], "Input",Expressi\
onUUID->"568831d6-c05c-49b9-a231-a04e6b04bb5a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
    "Bucklin_voting"}]}], " ", "*)"}]], "Input",ExpressionUUID->"48a792f7-\
2e77-488a-a14f-2e0c2ef1b710"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TopNumFunction", "[", 
   RowBox[{
   "counts_", ",", "wt_", ",", "prefs_", ",", "cands_", ",", " ", "num_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"adjnum", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"adjnum", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Length", "[", "prefs", "]"}], ",", "num"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"counts", "[", 
         RowBox[{"prefs", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "+=", " ", "wt"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"k", ",", "adjnum"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"dc186a48-ed70-\
46fc-89c7-0cfbdd54309c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TopNum", "[", 
   RowBox[{"ballots_", ",", "num_"}], "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", 
    RowBox[{
     RowBox[{"TopNumFunction", "[", 
      RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4", ",", "num"}], "]"}], 
     "&"}]}], "]"}]}]], "Input",ExpressionUUID->"07f9aa40-d7df-47cc-b3a2-\
accd474acf26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TopNumList", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"GetCandidates", "[", "ballots", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"TopNum", "[", 
        RowBox[{"ballots", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"4a45d89f-9753-4fd2-8d2b-604b3c3b9bbf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rank Counting", "Subsection",ExpressionUUID->"1c0d6299-0f43-46c6-9b2f-3c420b9f266c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
    "Borda_count"}]}], " ", "*)"}]], "Input",ExpressionUUID->"9a6bcaf4-e542-\
4a02-8ff1-5d021651d429"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BordaFunction", "[", 
   RowBox[{"counts_", ",", "wt_", ",", "prefs_", ",", "cands_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"maxnum", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxnum", " ", "=", " ", 
      RowBox[{"Length", "[", "cands", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"counts", "[", 
         RowBox[{"prefs", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "+=", " ", 
        RowBox[{"wt", "*", 
         RowBox[{"(", 
          RowBox[{"maxnum", " ", "-", " ", "k", " ", "+", " ", "1"}], 
          ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"ec1372ff-bfd5-42d8-bfbb-82f2d3ccc623"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Borda", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", "BordaFunction"}], "]"}]}]], "Input",ExpressionUUID\
->"3c03649e-db5e-4d24-b9db-098a0a6667e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ModBordaFunction", "[", 
   RowBox[{"counts_", ",", "wt_", ",", "prefs_", ",", "cands_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"maxnum", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxnum", " ", "=", " ", 
      RowBox[{"Length", "[", "prefs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"counts", "[", 
         RowBox[{"prefs", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "+=", " ", 
        RowBox[{"wt", "*", 
         RowBox[{"(", 
          RowBox[{"maxnum", " ", "-", " ", "k", " ", "+", " ", "1"}], 
          ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"e0619d84-6318-41dc-9652-aa629cbf3077"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ModBorda", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", "ModBordaFunction"}], "]"}]}]], "Input",ExpressionU\
UID->"81a53712-1f75-4bc9-97f1-aa12ef188906"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
    "Cumulative_voting"}]}], " ", "*)"}]], "Input",ExpressionUUID->"8a43483f-\
520c-4891-bc15-0dfb5b634065"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CumulBordaFunction", "[", 
   RowBox[{"counts_", ",", "wt_", ",", "prefs_", ",", "cands_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxnum", ",", "n", ",", "k", ",", "indcount", ",", "pref", ",", 
      "ictotal"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxnum", " ", "=", " ", 
      RowBox[{"Length", "[", "prefs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"indcount", "[", 
         RowBox[{"prefs", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"0.", " ", "+", " ", 
         RowBox[{"wt", "*", 
          RowBox[{"(", 
           RowBox[{"maxnum", " ", "-", " ", "k", " ", "+", " ", "1"}], 
           ")"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ictotal", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"indcount", "[", "pref", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pref", ",", "prefs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"counts", "[", 
         RowBox[{"prefs", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "+=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"wt", "*", 
           RowBox[{"indcount", "[", 
            RowBox[{"prefs", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ")"}], "/", 
         "ictotal"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"4f2bd8ea-dedf-47ff-b5e0-635b1a66c3e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CumulBorda", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"BBoxCounter", "[", 
   RowBox[{"ballots", ",", "CumulBordaFunction"}], "]"}]}]], "Input",Expressio\
nUUID->"186d270e-7645-4c92-b10f-afea4af5c3b8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"https", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
    "Majority_judgment"}]}], " ", "*)"}]], "Input",ExpressionUUID->"b993ad03-\
0ee3-4a79-aef2-09ed605b81e0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"arg", ":", " ", 
   RowBox[{"list", " ", "of", " ", 
    RowBox[{"{", 
     RowBox[{"rank", ",", " ", "weight"}], "}"}]}]}], " ", "*)"}]], "Input",Ex\
pressionUUID->"eccacd9e-6b3a-462b-9475-8045fbf83c48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightedMedian", "[", "wtrnks_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wrsort", ",", "rks", ",", "cwts", ",", "totwt", ",", " ", "cwtrks", ",",
       "rksum", ",", "rkcnt", ",", "hftot", ",", "n", ",", "k", ",", 
      "addmdn"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Sort", " ", "by", " ", "ranks", " ", "and", " ", "find", " ", 
      "cumulative", " ", "weights"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wrsort", " ", "=", " ", 
      RowBox[{"SortBy", "[", 
       RowBox[{"wtrnks", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rks", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "wrsort"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"cwts", " ", "=", " ", 
      RowBox[{"Accumulate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", "wrsort"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totwt", " ", "=", " ", 
      RowBox[{"Last", "[", "cwts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cwts", " ", "=", " ", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Most", "[", "cwts", "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cwtrks", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"rks", ",", "cwts"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Search", " ", "through", " ", "to", " ", "find", " ", "contributors", 
       " ", "to", " ", "the", " ", 
       RowBox[{"median", " ", "--"}], " ", "those", " ", "that", " ", "make", 
       " ", "the", " ", "boolean", " ", "variable", " ", "addmdn", " ", 
       RowBox[{"true", ".", " ", "Add"}], " ", "up", " ", "their", " ", 
       "contributions", " ", "in", " ", "rksum", " ", 
       RowBox[{"(", 
        RowBox[{"sum", " ", "of", " ", "ranks"}], ")"}], " ", "and", " ", 
       "rkcnt", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"count", " ", "of", " ", "ranks"}], ")"}], "."}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rksum", " ", "=", " ", "0."}], ";", " ", 
     RowBox[{"rkcnt", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "cwtrks", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hftot", " ", "=", " ", 
      RowBox[{"totwt", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"addmdn", " ", "=", " ", 
         RowBox[{
          RowBox[{"cwtrks", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "2"}], "]"}], "]"}], " ", "\[LessEqual]", " ", 
          "hftot"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"addmdn", ",", "\[IndentingNewLine]", 
          RowBox[{"addmdn", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "<", "n"}], ",", 
             RowBox[{
              RowBox[{"cwtrks", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "+", "1"}], ",", "2"}], "]"}], "]"}], 
              "\[GreaterEqual]", "hftot"}], ",", "True"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"addmdn", ",", " ", 
          RowBox[{
           RowBox[{"rksum", " ", "+=", " ", 
            RowBox[{"cwtrks", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ";", " ", 
           RowBox[{"rkcnt", " ", "+=", " ", "1"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Finally", ",", " ", 
       RowBox[{"the", " ", "median"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rksum", "/", "rkcnt"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"22c81edc-b37f-44d0-873b-6e9ba5d51b80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MajorityJudgment", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cands", ",", "ncands", ",", "ballot", ",", "wt", ",", "prefs", ",", "k",
       ",", "candranks", ",", "candranklists", ",", "candwms"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Find", " ", "the", " ", "ranks", " ", "of", " ", "all", " ", "the", 
       " ", "candidates", " ", "in", " ", "the", " ", 
       RowBox[{"ballots", ".", " ", "One"}], " ", "that", " ", "is", " ", 
       "not", " ", "voted", " ", "for", " ", "gets", " ", "a", " ", "rank", 
       " ", "of", " ", "zero"}], ",", " ", 
      RowBox[{"below", " ", "all", " ", "those", " ", "voted", " ", "for"}]}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ncands", " ", "=", " ", 
      RowBox[{"Length", "[", "cands", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"candranks", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"wt", ",", "prefs"}], "}"}], " ", "=", " ", "ballot"}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"prefs", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", 
                 RowBox[{"ncands", "-", "k", "+", "1"}], " ", ",", "wt"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", "prefs", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "0", ",", "wt"}], "}"}], "&"}], " ", "/@", 
              " ", 
              RowBox[{"Complement", "[", 
               RowBox[{"cands", ",", "prefs"}], "]"}]}]}], "]"}]}], ",", " ", 
          
          RowBox[{"{", 
           RowBox[{"ballot", ",", "ballots"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"candranklists", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], ",", 
          RowBox[{"Rest", " ", "/@", " ", "#"}]}], "}"}], "&"}], " ", "/@", 
       " ", 
       RowBox[{"GatherBy", "[", 
        RowBox[{"candranks", ",", "First"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"candwms", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"WeightedMedian", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], " ", "/@", 
       " ", "candranklists"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SortBy", "[", 
      RowBox[{"candwms", ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"f2bfdc3f-7836-\
4ada-b9be-af1c767a9f37"]
}, Closed]],

Cell[CellGroupData[{

Cell["Multistep", "Subsection",ExpressionUUID->"a05f95c4-182c-4a51-b113-c2888bf076d8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Contingent_vote"}], "\n", 
     RowBox[{"http", ":"}]}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     "Two"}], "-", "round_system"}]}], "\[IndentingNewLine]", "*)"}]], "Input",\
ExpressionUUID->"7ee69943-d7db-4bc6-a406-fe2c0b470619"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TopTwoRunoff", "[", 
   RowBox[{"ballots_", ",", 
    RowBox[{"DoRound_:", "TopOne"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rounds", ",", "res", ",", "TopTwoCands", ",", "MaxVotes", ",", "r", ",",
       "newballots"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rounds", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"DoRound", "[", "ballots", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "res", "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"Return", "[", "rounds", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"rounds", ",", "res"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "top", " ", "two", " ", "or", " ", "top", " ", "ones", " ",
        "with", " ", "the", " ", "same", " ", "vote"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"TopTwoCands", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MaxVotes", " ", "=", " ", 
      RowBox[{"res", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", 
           "MaxVotes"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "TopTwoCands", "]"}], " ", 
              "\[GreaterEqual]", " ", "2"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"MaxVotes", " ", "=", " ", 
            RowBox[{"r", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"TopTwoCands", ",", 
          RowBox[{"r", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"r", ",", "res"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"newballots", " ", "=", " ", 
      RowBox[{"KeepCandidates", "[", 
       RowBox[{"ballots", ",", " ", "TopTwoCands"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"DoRound", "[", "newballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"rounds", ",", " ", "res"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "rounds"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"4df8eba8-58c4-4bf9-9a1d-05603e622bf9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"http", ":"}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
         "Instant"}], "-", 
        RowBox[{"runoff_voting", "\[IndentingNewLine]", 
         RowBox[{"http", ":"}]}]}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
        "Exhaustive_ballot"}], "\[IndentingNewLine]", 
       RowBox[{"http", ":"}]}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
       "Nanson"}], "%27", "s_method", "\[IndentingNewLine]", 
      RowBox[{"http", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Coombs"}], "%27", "_method", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Baldwin", ":", " ", "ballots"}]}]}], ",", " ", "Min", ",", " ", 
   
   RowBox[{"Borda", "\[IndentingNewLine]", 
    RowBox[{"Nanson", ":", " ", "ballots"}]}], ",", " ", "Mean", ",", " ", 
   RowBox[{"Borda", "\[IndentingNewLine]", 
    RowBox[{"Coombs", ":", " ", "ballots"}]}], ",", " ", "Min", ",", " ", 
   "MinusBottom"}], "\[IndentingNewLine]", "*)"}]], "Input",ExpressionUUID->\
"27a388de-c6c0-4467-b986-32e8975ecdd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SequentialRunoff", "[", 
   RowBox[{"ballots_", ",", 
    RowBox[{"ThresholdFunc_:", "Min"}], ",", 
    RowBox[{"DoRound_:", "TopOne"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newballots", ",", "rounds", ",", "res", ",", "VoteThreshold", ",", 
      "BottomCands"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newballots", " ", "=", " ", 
      RowBox[{"RemoveEmptyBallots", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rounds", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "newballots", "]"}], " ", ">", " ", "0"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"DoRound", "[", "newballots", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rounds", ",", "res"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"VoteThreshold", " ", "=", " ", 
         RowBox[{"ThresholdFunc", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", "res"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BottomCands", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"res", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
              "VoteThreshold"}], "&"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newballots", " ", "=", " ", 
         RowBox[{"RemoveCandidates", "[", 
          RowBox[{"newballots", ",", " ", "BottomCands"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "rounds"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"b214d216-eced-\
4b37-885d-7ad0eebe4366"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     "Single_transferable"}], "_vote"}]}], " ", "*)"}]], "Input",ExpressionUUI\
D->"83886cdc-52fa-4bf8-9ff1-c970cc1c3467"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SingleTransferableVote", "[", 
   RowBox[{"ballots_", ",", " ", "num_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "quota", ",", "newballots", ",", "rounds", ",", "winners", ",", " ", 
      "res", ",", "MaxVotes", ",", " ", "TopCands", ",", "excess", ",", 
      "ballot", ",", "wt", ",", "prefs", ",", "BottomCands", ",", 
      "MinVotes"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"The", " ", "Hagenbach"}], "-", 
       RowBox[{"Bischoff", " ", "quota"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "a", " ", "fractional", " ", "version", " ", "of", " ", "the", " ", 
        "Droop", " ", "quota", "\[IndentingNewLine]", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
         "Hagenbach"}], "-", "Bischoff_quota"}]}]}], "\[IndentingNewLine]", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"quota", " ", "=", " ", 
      RowBox[{
       RowBox[{"TotalCount", "[", "ballots", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"num", " ", "+", " ", "1."}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newballots", " ", "=", " ", 
      RowBox[{"RemoveEmptyBallots", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rounds", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"winners", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "newballots", "]"}], " ", ">", " ", "0"}], 
        " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "winners", "]"}], " ", "<", " ", "num"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"TopOne", "[", "newballots", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "for", " ", 
          RowBox[{"winners", ".", " ", "Find"}], " ", "top", " ", 
          "candidates", " ", "with", " ", "the", " ", "same", " ", "Vote"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"MaxVotes", " ", "=", " ", 
         RowBox[{"res", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"TopCands", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"res", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "MaxVotes"}], 
             "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"excess", " ", "=", " ", 
         RowBox[{"MaxVotes", " ", "-", " ", "quota"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"excess", " ", ">=", " ", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Adjust", " ", "weights", " ", "to", " ", "use", " ", 
            RowBox[{"winners", "'"}], " ", "excess", " ", "votes"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newballots", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"wt", ",", "prefs"}], "}"}], " ", "=", " ", 
                "ballot"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"TopCands", ",", 
                   RowBox[{"First", "[", "prefs", "]"}]}], "]"}], ",", 
                 RowBox[{"wt", " ", "*=", " ", 
                  RowBox[{"excess", "/", "MaxVotes"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"wt", ",", "prefs"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"ballot", ",", "newballots"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newballots", " ", "=", " ", 
            RowBox[{"RemoveCandidates", "[", 
             RowBox[{"newballots", ",", "TopCands"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"winners", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"winners", ",", "TopCands"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"rounds", ",", 
             RowBox[{"{", 
              RowBox[{"res", ",", "\"\<+\>\"", ",", "TopCands"}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "for", " ", 
          RowBox[{"losers", ".", " ", "Find"}], " ", "bottom", " ", "ones", 
          " ", "with", " ", "the", " ", "same", " ", "vote"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"MinVotes", " ", "=", " ", 
         RowBox[{"res", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BottomCands", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"res", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "==", "MinVotes"}], "&"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newballots", " ", "=", " ", 
         RowBox[{"RemoveCandidates", "[", 
          RowBox[{"newballots", ",", "BottomCands"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rounds", ",", 
          RowBox[{"{", 
           RowBox[{"res", ",", "\"\<-\>\"", ",", "BottomCands"}], "}"}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"rounds", ",", "winners"}], "]"}], ";", "\[IndentingNewLine]", 
     "rounds"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"c16908b9-a65c-4fe1-a69f-edce210716ee"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Comparison", " ", "of", " ", "Pairs", " ", "of", " ", "Outcomes"}], " ", 
    "+", " ", 
    RowBox[{
     RowBox[{"STV", " ", "--"}], " ", 
     RowBox[{"http", ":"}]}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     "CPO"}], "-", "STV"}]}], " ", "*)"}]], "Input",ExpressionUUID->"87012073-\
0eb3-4468-b4b1-a9e376349c3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompPairOutcomesSTV", "[", 
   RowBox[{"ballots_", ",", "num_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "quota", ",", "cands", ",", "candposses", ",", "ncp", ",", "CprMat", ",",
       "k1", ",", "k2", ",", "cands1", ",", "cands2", ",", "inboth", ",", 
      "inneither", ",", "newballots", ",", "TotalOverThreshold", ",", "res", 
      ",", "VotesOverThreshold", ",", "CandsOverThreshold", ",", "r", ",", 
      "NumOverThreshold", ",", "ballot", ",", "wt", ",", "prefs", ",", 
      "totalvotes", ",", "total1", ",", "total2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"quota", " ", "=", " ", 
      RowBox[{
       RowBox[{"TotalCount", "[", "ballots", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"num", " ", "+", " ", "1."}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"candposses", " ", "=", " ", 
      RowBox[{"Subsets", "[", 
       RowBox[{"cands", ",", 
        RowBox[{"{", "num", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ncp", " ", "=", " ", 
      RowBox[{"Length", "[", "candposses", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CprMat", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"ncp", ",", "ncp"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"cands1", " ", "=", " ", 
         RowBox[{"candposses", "[", 
          RowBox[{"[", "k1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cands2", " ", "=", " ", 
         RowBox[{"candposses", "[", 
          RowBox[{"[", "k2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inboth", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{"cands1", ",", "cands2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inneither", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{"cands", ",", "cands1", ",", "cands2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Eliminate", " ", "candidates", " ", "in", " ", "neither", " ", 
          "possibilities"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newballots", " ", "=", " ", 
         RowBox[{"RemoveCandidates", "[", 
          RowBox[{"ballots", ",", "inneither"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"TotalOverThreshold", " ", "=", " ", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Eliminate", " ", "over"}], "-", 
          RowBox[{
          "threshold", " ", "candidates", " ", "in", " ", "both", " ", 
           "possibilities"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"TopOne", "[", "newballots", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Clear", "[", "VotesOverThreshold", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"CandsOverThreshold", " ", "=", " ", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"inboth", ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "\[GreaterEqual]", " ",
                  "quota"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CandsOverThreshold", ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"VotesOverThreshold", "[", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"r", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"r", ",", "res"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NumOverThreshold", " ", "=", " ", 
            RowBox[{"Length", "[", "CandsOverThreshold", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumOverThreshold", " ", "\[LessEqual]", " ", "0"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"TotalOverThreshold", "+=", "NumOverThreshold"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"newballots", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"wt", ",", "prefs"}], "}"}], " ", "=", " ", 
                "ballot"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"CandsOverThreshold", ",", 
                   RowBox[{"First", "[", "prefs", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"totalvotes", " ", "=", " ", 
                   RowBox[{"VotesOverThreshold", "[", 
                    RowBox[{"First", "[", "prefs", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"wt", " ", "*=", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"totalvotes", " ", "-", " ", "quota"}], ")"}], 
                    " ", "/", " ", "totalvotes"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"wt", ",", "prefs"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"ballot", ",", "newballots"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newballots", " ", "=", " ", 
            RowBox[{"RemoveCandidates", "[", 
             RowBox[{"newballots", ",", "CandsOverThreshold"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"total1", " ", "=", " ", 
         RowBox[{"total2", " ", "=", " ", 
          RowBox[{"TotalOverThreshold", "*", "quota"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total1", " ", "+=", " ", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"res", ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"cands1", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"total2", " ", "+=", " ", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"res", ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"cands2", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CprMat", "[", 
          RowBox[{"[", 
           RowBox[{"k1", ",", "k2"}], "]"}], "]"}], "=", "total1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CprMat", "[", 
          RowBox[{"[", 
           RowBox[{"k2", ",", "k1"}], "]"}], "]"}], "=", "total2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k1", ",", 
         RowBox[{"ncp", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", 
         RowBox[{"k1", "+", "1"}], ",", "ncp"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"candposses", ",", "CprMat"}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",ExpressionUUID->"ba4ace2f-8ea3-43f1-8ee2-8a4b8127c831"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     "Schulze_STV"}], "\[IndentingNewLine]", "Not", " ", "implemented", " ", 
    "because", " ", "of", " ", "the", " ", "difficulty", " ", "of", " ", 
    "understanding", " ", "the", " ", "algorithm"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",ExpressionUUID->"ccd26623-5799-4170-8f12-dd8d4f1dc8c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Condorcet Setup", "Subsection",ExpressionUUID->"a630791f-103b-4140-9b89-ef73f1b36bfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondorcetMatrix", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cands", ",", "n", ",", "cdix", ",", "prefmat", ",", "ballot", ",", "wt",
       ",", "prefs", ",", "ranks", ",", "k", ",", " ", "k1", ",", " ", "k2"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "cands", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lstoix", "[", 
      RowBox[{"cands", ",", "cdix"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"prefmat", " ", "is", " ", "that", " ", "matrix"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"prefmat", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wt", ",", "prefs"}], "}"}], " ", "=", " ", "ballot"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Ranks", "--"}], " ", "ranked", " ", "candidates", " ", 
          "get", " ", "from", " ", "at", " ", "least", " ", "1", " ", "to", 
          " ", "n", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"max", " ", "rank"}], ")"}], ".", "\[IndentingNewLine]", 
           "Unranked"}], " ", "ones", " ", "get", " ", "0."}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ranks", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ranks", "[", 
            RowBox[{"[", 
             RowBox[{"cdix", "[", 
              RowBox[{"prefs", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], " ", "=", 
           " ", 
           RowBox[{"n", " ", "-", " ", "k", " ", "+", " ", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "prefs", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ranks", "[", 
              RowBox[{"[", "k1", "]"}], "]"}], " ", ">", " ", 
             RowBox[{"ranks", "[", 
              RowBox[{"[", "k2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"prefmat", "[", 
              RowBox[{"[", 
               RowBox[{"k1", ",", "k2"}], "]"}], "]"}], " ", "+=", " ", 
             "wt"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ballot", ",", "ballots"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "prefmat"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"24c157ab-71bb-419c-a565-bc825bc326ec"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "PrefOrderFunction", " ", "takes", " ", "the", " ", "Condorcet", " ", 
   "matrix", " ", "and", " ", "returns", " ", "the", " ", "preference", " ", 
   "order", " ", "as", " ", "indices"}], " ", "*)"}]], "Input",ExpressionUUID-\
>"005f3640-e5bb-4907-98be-3b7e4b6718a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondorcetPrefOrder", "[", 
   RowBox[{"ballots_", ",", "PrefOrderFunction_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cands", ",", "preforder"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"preforder", " ", "=", " ", 
      RowBox[{"PrefOrderFunction", "[", 
       RowBox[{"CondorcetMatrix", "[", "ballots", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cands", "[", 
      RowBox[{"[", "preforder", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"2eb649f4-4c9d-45ee-b06d-4c8bbcae3df3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "PrefCountFunction", " ", "takes", " ", "the", " ", "Condorcet", " ", 
   "matrix", " ", "and", " ", "returns", " ", "a", " ", "count", " ", "or", 
   " ", "some", " ", "other", " ", "value", " ", "for", " ", "each", " ", 
   "candidate"}], " ", "*)"}]], "Input",ExpressionUUID->"be30c2ac-4095-40e3-\
a934-84d36e6db85a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondorcetPrefCount", "[", 
   RowBox[{"ballots_", ",", "PrefCountFunction_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cands", ",", "prefcount"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prefcount", " ", "=", " ", 
      RowBox[{"PrefCountFunction", "[", 
       RowBox[{"CondorcetMatrix", "[", "ballots", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"cands", ",", "prefcount"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"0dcc46fe-fd4c-\
432b-a8d9-ecce1a114f24"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Find", " ", "all", " ", "permutations", " ", "of", " ", "1"}], 
     " ", "..."}], " ", "n", " ", "and", " ", "call", " ", "a", " ", 
    "function", " ", "on", " ", "each", " ", "permutation", " ", "with", " ", 
    "argments", " ", 
    RowBox[{"(", "permutation", ")"}]}], ",", " ", 
   RowBox[{"(", "data", ")"}], ",", " ", 
   RowBox[{
   "a", " ", "function", " ", "that", " ", "returns", " ", "an", " ", 
    "updated", " ", "value", " ", "of", " ", 
    RowBox[{
     RowBox[{"(", "data", ")"}], ".", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "Done"}], " ", "using", " ", "a", " ", 
    "lexicographic", " ", "sorting", " ", "algorithm", " ", "to", " ", 
    "avoid", " ", "creating", " ", "a", " ", "big", " ", "list"}], ",", " ", 
   RowBox[{"as", " ", 
    RowBox[{"Permutations", "[", "]"}], " ", "does"}]}], " ", "*)"}]], "Input",\
ExpressionUUID->"4b618bf5-5bdf-451b-aca5-0e29f6ddc121"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyPermutations", "[", 
   RowBox[{"n_", ",", "f_", ",", "data_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "seq", ",", "dnew", ",", "ix", ",", "i", ",", "sqix", ",", "iy", ",", 
      "sqiy", ",", "si"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"seq", " ", "=", " ", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dnew", " ", "=", " ", 
      RowBox[{"f", "[", 
       RowBox[{"seq", ",", "data"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Find", " ", "rightmost", " ", "member", " ", 
         RowBox[{"that", "'"}], "s", " ", "smaller", " ", "than", " ", "the", 
         " ", "one", " ", "just", " ", "after", " ", "it"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ix", " ", "=", " ", 
         RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"seq", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<", 
             RowBox[{"seq", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ix", " ", "=", " ", "i"}], ";", " ", 
             RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"n", "-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", " ", "there", " ", "is", " ", "none"}], ",", " ", 
          RowBox[{"then", " ", 
           RowBox[{"we", "'"}], "re", " ", "done"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Find", " ", "smallest", " ", "member", " ", "greater", " ", "than", 
          " ", "the", " ", "ix", " ", "member"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sqix", " ", "=", " ", 
         RowBox[{"seq", "[", 
          RowBox[{"[", "ix", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iy", " ", "=", " ", 
         RowBox[{"ix", " ", "+", " ", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sqiy", " ", "=", " ", 
         RowBox[{"seq", "[", 
          RowBox[{"[", "iy", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"si", " ", "=", " ", 
            RowBox[{"seq", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"si", " ", ">", " ", "sqix"}], " ", "&&", " ", 
              RowBox[{"si", " ", "<", " ", "sqiy"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"iy", " ", "=", " ", "i"}], ";", " ", 
              RowBox[{"sqiy", " ", "=", " ", "si"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"ix", "+", "2"}], ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Swap", " ", "the", " ", "two", " ", "previous", " ", "members", " ",
           "found"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"seq", "[", 
          RowBox[{"[", "ix", "]"}], "]"}], " ", "=", " ", "sqiy"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"seq", "[", 
          RowBox[{"[", "iy", "]"}], "]"}], " ", "=", " ", "sqix"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Sort", " ", 
          RowBox[{"what", "'"}], "s", " ", "beyond", " ", "the", " ", "lower",
           " ", "one"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"seq", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"seq", "[", 
            RowBox[{"[", 
             RowBox[{";;", "ix"}], "]"}], "]"}], ",", 
           RowBox[{"Sort", "[", 
            RowBox[{"seq", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ix", "+", "1"}], ";;"}], "]"}], "]"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnew", " ", "=", " ", 
         RowBox[{"f", "[", 
          RowBox[{"seq", ",", "dnew"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "dnew"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"987c4fa7-181f-4e45-bab4-fc9e8374091d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "All", " ", "the", " ", "disjoint", " ", "cycles", " ", "in", " ", "a", " ",
    "permutation"}], " ", "*)"}]], "Input",ExpressionUUID->"645226d3-43b5-\
4ccb-8647-a975282ff2ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"permcycles", "[", "perm_", "]"}], " ", ":=", " ", 
  RowBox[{"PermutationCycles", "[", 
   RowBox[{"perm", ",", "Identity"}], "]"}]}]], "Input",ExpressionUUID->\
"e0e30fed-c0a1-4d30-8279-ef7300c10002"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Acyclic", "-", 
   RowBox[{"graph", " ", "testing"}]}], " ", "*)"}]], "Input",ExpressionUUID->\
"58bd436c-5a24-4ce8-8629-e2be516112ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsAcyclic", "[", "blext_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "blxgraf", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"blxgraf", " ", "=", " ", 
      RowBox[{"Graph", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"DirectedEdge", " ", "@@", " ", "#"}], ")"}], "&"}], " ", "/@",
         " ", "blext"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AcyclicGraphQ", "[", "blxgraf", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"0cdd3792-45d8-\
4f67-a27b-38b424616a35"]
}, Closed]],

Cell[CellGroupData[{

Cell["Condorcet Methods", "Subsection",ExpressionUUID->"b6242a00-224a-45d8-a97d-89676c5703c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondorcetWinnerIndex", "[", "prefmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "i", ",", "j", ",", "wix", ",", "wixtot"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wixtot", " ", "=", " ", "Null"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"wix", " ", "=", " ", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "\[NotEqual]", "i"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"prefmat", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "\[LessEqual]", 
              " ", 
              RowBox[{"prefmat", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"wix", " ", "=", " ", "Null"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"wix", " ", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"wixtot", " ", "=", " ", "wix"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "wixtot"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"d85df959-9e6c-4561-9fa0-343e3af02fda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondorcetWinner", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cands", ",", "wix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wix", " ", "=", " ", 
      RowBox[{"CondorcetWinnerIndex", "[", 
       RowBox[{"CondorcetMatrix", "[", "ballots", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wix", " ", "=!=", " ", "Null"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"True", ",", 
         RowBox[{"cands", "[", 
          RowBox[{"[", "wix", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", "False", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"acc0908e-34fc-41a0-bc8d-4c19bc6e6fd0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Schulze", " ", 
    RowBox[{"beatpath", " ", "--"}], " ", 
    RowBox[{"http", ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
    "Schulze_method"}]}], " ", "*)"}]], "Input",ExpressionUUID->"ca009228-\
ae37-481d-b4f2-baf9aa626f94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SchulzeOrdering", "[", 
   RowBox[{"bpmat_", ",", "i_", ",", "j_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bij", ",", "bji"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bij", " ", "=", " ", 
      RowBox[{"bpmat", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bji", " ", "=", " ", 
      RowBox[{"bpmat", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"bji", " ", "\[NotEqual]", " ", "bij"}], ",", 
       RowBox[{"bij", " ", ">", " ", "bji"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", "j"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",ExpressionUUID->"c13fcbb4-6910-4fc7-8e6d-63be5b0531c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SchulzePrefOrder", "[", "prefmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "i", ",", "j", ",", "k", ",", " ", "bpmat"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Beatpaths", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bpmat", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Variant", " ", "of", " ", "Floyd"}], "-", 
       RowBox[{"Warshall", " ", "algorithm"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", " ", "\[NotEqual]", " ", "i"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bpmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"prefmat", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", ">", " ", 
             RowBox[{"prefmat", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", " ", "0"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[NotEqual]", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "\[NotEqual]", "k"}], " ", "&&", " ", 
              RowBox[{"j", "\[NotEqual]", "k"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bpmat", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"bpmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"bpmat", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"bpmat", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Range", "[", "n", "]"}], ",", 
       RowBox[{
        RowBox[{"SchulzeOrdering", "[", 
         RowBox[{"bpmat", ",", "#1", ",", "#2"}], "]"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"0e123b7e-7c83-4928-8de4-6fcdbe66d62f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Schulze", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"CondorcetPrefOrder", "[", 
   RowBox[{"ballots", ",", "SchulzePrefOrder"}], "]"}]}]], "Input",ExpressionU\
UID->"f0156584-b2c1-4f95-a880-af2501482d48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CPOSTVSchulze", "[", 
   RowBox[{"ballots_", ",", "num_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"candsets", ",", "prefmat", ",", "pmord"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"candsets", ",", "prefmat"}], "}"}], " ", "=", " ", 
      RowBox[{"CompPairOutcomesSTV", "[", 
       RowBox[{"ballots", ",", "num"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pmord", " ", "=", " ", 
      RowBox[{"SchulzePrefOrder", "[", "prefmat", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "pmord", "]"}], " ", ">", " ", "0"}], ",", " ", 
       RowBox[{"candsets", "[", 
        RowBox[{"[", 
         RowBox[{"First", "[", "pmord", "]"}], "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"96469c98-d8da-\
4898-aae7-7f9a7be6c999"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Copeland", " ", "pairwise", " ", 
    RowBox[{"aggregation", " ", "--"}], " ", 
    RowBox[{"http", ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     "Copeland"}], "%27", "s_method"}]}], " ", "*)"}]], "Input",ExpressionUUID\
->"c3397b38-9993-4c9d-9dda-0824985511ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CopelandPrefCount", "[", "prefmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "k1", ",", "k2", ",", "counts", ",", "p12", ",", "p21"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"counts", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p12", " ", "=", " ", 
         RowBox[{"prefmat", "[", 
          RowBox[{"[", 
           RowBox[{"k1", ",", "k2"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{"p21", " ", "=", " ", 
         RowBox[{"prefmat", "[", 
          RowBox[{"[", 
           RowBox[{"k2", ",", "k1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p12", " ", ">", " ", "p21"}], ",", 
          RowBox[{
           RowBox[{"counts", "[", 
            RowBox[{"[", "k1", "]"}], "]"}], "++"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p12", " ", "<", " ", "p21"}], ",", 
          RowBox[{
           RowBox[{"counts", "[", 
            RowBox[{"[", "k1", "]"}], "]"}], "--"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "counts"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"d5f6fc63-d4bd-4bbd-9462-bbd3a24d6dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Copeland", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"CondorcetPrefCount", "[", 
   RowBox[{"ballots", ",", "CopelandPrefCount"}], "]"}]}]], "Input",Expression\
UUID->"43c783e9-14c7-449c-91ec-1cb2029e4042"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"http", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
       "Minimax_condorcet"}], "\[IndentingNewLine]", 
      RowBox[{"which", " ", "--"}], " ", "which", " ", 
      RowBox[{"method", ":", " ", "\"\<wins\>\""}]}]}], " ", "=", " ", 
    RowBox[{"winning", " ", "votes"}]}], ",", " ", 
   RowBox[{"\"\<marg\>\"", " ", "=", " ", "margins"}], ",", " ", 
   RowBox[{"\"\<oppo\>\"", " ", "=", " ", 
    RowBox[{"pairwise", " ", "opposition"}]}]}], " ", "*)"}]], "Input",Express\
ionUUID->"1b926925-cdec-4091-9b22-978b8d2d2386"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinimaxPrefCount", "[", 
   RowBox[{"prefmat_", ",", " ", "which_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "score", ",", "newscore", ",", "kx"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"score", "  ", "=", " ", "Null"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"kx", " ", "\[Equal]", " ", "k"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newscore", " ", "=", " ", 
            RowBox[{"Switch", "[", 
             RowBox[{"which", ",", "\[IndentingNewLine]", "\"\<wins\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"prefmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"kx", ",", "k"}], "]"}], "]"}], " ", ">", " ", 
                 RowBox[{"prefmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "kx"}], "]"}], "]"}]}], ",", 
                RowBox[{"prefmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"kx", ",", "k"}], "]"}], "]"}], ",", "0"}], "]"}], 
              ",", "\[IndentingNewLine]", "\"\<marg\>\"", ",", 
              RowBox[{
               RowBox[{"prefmat", "[", 
                RowBox[{"[", 
                 RowBox[{"kx", ",", "k"}], "]"}], "]"}], " ", "-", " ", 
               RowBox[{"prefmat", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "kx"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\"\<oppo\>\"", ",", 
              RowBox[{"prefmat", "[", 
               RowBox[{"[", 
                RowBox[{"kx", ",", "k"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"score", " ", "===", " ", "Null"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"score", " ", "=", " ", "newscore"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"newscore", " ", ">", " ", "score"}], ",", " ", 
               RowBox[{"score", " ", "=", " ", "newscore"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"kx", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">", "1"}], ",", 
          RowBox[{"-", "score"}], ",", "0"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"d1483377-a035-4c05-88b1-e89b422f7a4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Minimax", "[", 
   RowBox[{"ballots_", ",", "which_"}], "]"}], " ", ":=", " ", 
  RowBox[{"CondorcetPrefCount", "[", 
   RowBox[{"ballots", ",", " ", 
    RowBox[{
     RowBox[{"MinimaxPrefCount", "[", 
      RowBox[{"#", ",", "which"}], "]"}], "&"}]}], "]"}]}]], "Input",Expressio\
nUUID->"ff8c7d70-3aa2-4f21-82b5-a36d9eb92ee2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     "Kemeny"}], "%", "E2", "%80", "%93", "Young_method"}]}], " ", 
  "*)"}]], "Input",ExpressionUUID->"1176fab1-2f7d-4a57-aee8-87ccb9bf8699"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KemenyYoungForPermute", "[", 
   RowBox[{"prefmat_", ",", "perm_", ",", "data_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "bestperm", ",", "bestscore", ",", "score", ",", "k1", ",", 
      "k2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bestperm", ",", "bestscore"}], "}"}], " ", "=", " ", "data"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"score", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"prefmat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"perm", "[", 
            RowBox[{"[", "k1", "]"}], "]"}], ",", 
           RowBox[{"perm", "[", 
            RowBox[{"[", "k2", "]"}], "]"}]}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", 
          RowBox[{"k1", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"bestscore", " ", "===", " ", "Null"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bestperm", " ", "=", " ", "perm"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bestscore", " ", "=", " ", "score"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"score", " ", ">", " ", "bestscore"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bestperm", " ", "=", " ", "perm"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bestscore", " ", "=", " ", "score"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"bestperm", ",", "bestscore"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"ad9b682a-8ab0-\
448c-b186-40d6edc1298e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KemenyYoungPrefOrder", "[", "prefmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", "Null"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"ApplyPermutations", "[", 
       RowBox[{"n", ",", 
        RowBox[{
         RowBox[{"KemenyYoungForPermute", "[", 
          RowBox[{"prefmat", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
        "data"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"635d8cd0-74b1-4c40-9ec9-600a84f80816"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KemenyYoung", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"CondorcetPrefOrder", "[", 
   RowBox[{"ballots", ",", "KemenyYoungPrefOrder"}], "]"}]}]], "Input",Express\
ionUUID->"aa2a8988-d1d3-4331-aa8e-95263094cf08"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"https", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
     RowBox[{"Dodgson", "'"}]}], "s_method"}]}], " ", "*)"}]], "Input",Express\
ionUUID->"77e3f2bc-261b-443e-a411-2a7881d3a8a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"permprefs", "[", 
   RowBox[{"prefs_", ",", "perm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "extperm", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"extperm", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "#"}], "}"}], "&"}], " ", "/@", " ", 
         "prefs"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "False", "}"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "perm", "]"}], "-", 
           RowBox[{"Length", "[", "prefs", "]"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"extperm", "[", 
         RowBox[{"[", "perm", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"78cdb117-2978-\
4a31-995a-b7784b614260"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DodgsonForPermute", "[", 
   RowBox[{"ballots_", ",", "perm_", ",", "data_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newballots", ",", "wix", ",", "newdata", ",", "permdist"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newballots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"permprefs", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "perm"}], "]"}]}], "}"}], 
        "&"}], " ", "/@", " ", "ballots"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wix", " ", "=", " ", 
      RowBox[{"CondorcetWinnerIndex", "[", 
       RowBox[{"CondorcetMatrix", "[", "newballots", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newdata", " ", "=", " ", "data"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wix", " ", "=!=", " ", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"permdist", " ", "=", " ", 
         RowBox[{
          RowBox[{"Length", "[", "perm", "]"}], " ", "-", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"permcycles", "[", "perm", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"permdist", " ", "<", " ", 
           RowBox[{"newdata", "[", 
            RowBox[{"[", "wix", "]"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"newdata", "[", 
            RowBox[{"[", "wix", "]"}], "]"}], " ", "=", " ", "permdist"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "newdata"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"eee83048-a9af-4e50-bc71-3ff886e46590"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dodgson", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cands", ",", "n", ",", "data"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "cands", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "value", " ", "for", " ", "no", " ", "Condorcet", " ", 
       "winner"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"data", "=", "  ", 
      RowBox[{"ApplyPermutations", "[", 
       RowBox[{"n", ",", 
        RowBox[{
         RowBox[{"DodgsonForPermute", "[", 
          RowBox[{"ballots", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
        "data"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"cands", ",", "data"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"010bb387-8eef-\
4f6b-9973-9657abe035c7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Tideman", "'"}], "s", " ", 
    RowBox[{"method", ":", " ", "http", ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Ranked_pairs"}], "\n", "Uses", " ", 
     RowBox[{"Mma", "'"}], "s", " ", "graph"}], "-", 
    RowBox[{"theory", " ", "algorithms"}]}]}], " ", "*)"}]], "Input",Expressio\
nUUID->"9db7daff-d46c-43b5-b7a3-612cc05335f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RankedPairsPrefOrder", "[", "prefmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "k1", ",", "k2", ",", "beatmargins", ",", "beatlist", ",", 
      "bmg", ",", "bd", ",", "blext", ",", "blxgraf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "beat", " ", "margins", " ", "and", " ", 
       "sort", " ", "them"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"beatmargins", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2", ",", 
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"k1", ",", "k2"}], "]"}], "]"}], ",", 
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"k2", ",", "k1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"beatmargins", " ", "=", " ", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"beatmargins", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "beat", " ", "list", " ", "of", " ", "what", 
       " ", "beats", " ", "what"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"beatlist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Get", " ", "a", " ", "pair", " ", "of", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"start", " ", "index"}], ",", " ", 
          RowBox[{"end", " ", "index"}]}], "}"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"bd", " ", "=", " ", 
         RowBox[{"bmg", "[", 
          RowBox[{"[", 
           RowBox[{";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"The", " ", "simplest", " ", "test", " ", "for", " ", 
          RowBox[{"cycles", " ", "--"}], " ", "reverse", " ", "direction"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"beatlist", ",", 
            RowBox[{"Reverse", "[", "bd", "]"}]}], "]"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Test", " ", "for", " ", "lack", " ", "of", " ", 
           RowBox[{"cyclicity", ".", " ", "First"}]}], ",", " ", 
          RowBox[{
          "test", " ", "reversing", " ", "the", " ", "direction", " ", "of", 
           " ", "the", " ", "addition"}], ",", " ", "then", ",", " ", 
          RowBox[{
           RowBox[{"test", " ", "using", " ", "a", " ", "graph"}], "-", 
           RowBox[{"theory", " ", "algorithm"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"beatlist", ",", 
            RowBox[{"Reverse", "[", "bd", "]"}]}], "]"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"blext", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"beatlist", ",", "bd"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IsAcyclic", "[", "blext", "]"}], ",", " ", 
          RowBox[{"beatlist", " ", "=", " ", "blext"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"bmg", ",", "beatmargins"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Range", "[", "n", "]"}], ",", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"beatlist", ",", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"16e58811-ef71-\
4869-a117-edf2d74c4229"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RankedPairs", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"CondorcetPrefOrder", "[", 
   RowBox[{"ballots", ",", "RankedPairsPrefOrder"}], "]"}]}]], "Input",Express\
ionUUID->"c24af58f-5fc1-4427-97e7-ed4bc04b5392"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Maximal", " ", 
      RowBox[{"lotteries", ":", " ", "https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
       "Maximal_lotteries"}], "\n", "Consistent", " ", "Probabilistic", " ", 
      "Social", " ", 
      RowBox[{"Choice", ":", " ", "https", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"arxiv", ".", "org"}], "/", "abs"}], "/", "1503.00694"}], 
     "\[IndentingNewLine]", 
     RowBox[{"http", ":"}]}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"econweb", ".", "ucsd", ".", "edu"}], "/", 
      RowBox[{"~", "jsobel"}]}], "/", "172"}], 
    RowBox[{"aw02", "/", 
     RowBox[{"notes9", ".", "pdf"}]}]}]}], " ", "*)"}]], "Input",ExpressionUUI\
D->"a649b60f-5873-4b28-83b8-d62f4e842da2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximalLotteriesProbs", "[", "prefmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "c1", ",", "c2", ",", "c3"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"c1", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c2", " ", "=", " ", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", "n"}], "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "prefmat", "]"}], " ", "-", " ", 
            "prefmat"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}], ",", "n"}], "]"}]}], "}"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c3", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", "n"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"LinearProgramming", "[", 
        RowBox[{"c1", ",", "c2", ",", "c3"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"13b1b6a1-42d9-4207-a508-9721e3f1d6b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximalLotteries", "[", "ballots_", "]"}], " ", ":=", " ", 
  RowBox[{"CondorcetPrefCount", "[", 
   RowBox[{"ballots", ",", "MaximalLotteriesProbs"}], "]"}]}]], "Input",Expres\
sionUUID->"0cdca87b-62c0-427f-a854-a7ddea69ac48"]
}, Closed]],

Cell[CellGroupData[{

Cell["Maximal Sets", "Subsection",ExpressionUUID->"955771f7-607f-437c-a2ef-4f62e5a3f305"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Find", " ", "the", " ", "Smith", " ", "and", " ", "Schwartz", " ", 
    "sets"}], ",", " ", 
   RowBox[{
    RowBox[{"from", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"wiki", ".", "electorama", ".", "com"}], "/", "wiki"}], "/", 
      "Maximal_elements"}], "_algorithms", "\[IndentingNewLine]", "Type", " ",
      "is", " ", "\"\<Schwartz\>\"", " ", 
     RowBox[{"(", ">", ")"}], " ", "or", " ", "\"\<Smith\>\"", " ", 
     RowBox[{"(", "\[GreaterEqual]", ")"}]}]}]}], " ", "*)"}]], "Input",Expres\
sionUUID->"60e403dc-751e-47e9-bf4b-773dd1235ba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrefMatRelations", "[", 
   RowBox[{"prefmat_", ",", " ", "type_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "k1", ",", "k2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "prefmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k2", " ", "\[NotEqual]", " ", "k1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"type", ",", "\[IndentingNewLine]", "\"\<Schwartz\>\"", ",", 
           RowBox[{
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"k1", ",", "k2"}], "]"}], "]"}], ">", " ", 
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"k2", ",", "k1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\"\<Smith\>\"", ",", 
           RowBox[{
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"k1", ",", "k2"}], "]"}], "]"}], " ", "\[GreaterEqual]",
             " ", 
            RowBox[{"prefmat", "[", 
             RowBox[{"[", 
              RowBox[{"k2", ",", "k1"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "False"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"e3bdd20a-9c8f-4827-995c-0bf2cb6a540f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FloydWarshallMaximal", "[", "relations_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "k1", ",", "k2", ",", "k", ",", "InMaximal", ",", "HasPath"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "relations", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"InMaximal", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"True", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Init", " ", "HasPath", " ", "for", " ", "relations", " ", "with", " ", 
       "length", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"HasPath", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k2", "\[NotEqual]", "k1"}], ",", 
          RowBox[{"relations", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", "k2"}], "]"}], "]"}], ",", "False"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consider", " ", "paths", " ", "with", " ", "intermediate", " ", 
       "nodes", " ", "from", " ", "1", " ", "to", " ", "k"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k1", " ", "\[NotEqual]", " ", "k"}], " ", "&&", " ", 
          RowBox[{"k2", " ", "\[NotEqual]", " ", "k"}], " ", "&&", " ", 
          RowBox[{"k2", " ", "\[NotEqual]", " ", "k1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"HasPath", "[", 
             RowBox[{"[", 
              RowBox[{"k1", ",", "k"}], "]"}], "]"}], " ", "&&", " ", 
            RowBox[{"HasPath", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "k2"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"HasPath", "[", 
             RowBox[{"[", 
              RowBox[{"k1", ",", "k2"}], "]"}], "]"}], " ", "=", " ", 
            "True"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Candidates", " ", "with", " ", "paths", " ", "to", " ", "them", " ", 
        "but", " ", "none", " ", "to", " ", "complete", " ", "a", " ", 
        "cycle"}], ",", " ", 
       RowBox[{
       "they", " ", "are", " ", "not", " ", "in", " ", "the", " ", "maximal", 
        " ", "set"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k2", " ", "\[NotEqual]", " ", "k1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"HasPath", "[", 
             RowBox[{"[", 
              RowBox[{"k2", ",", "k1"}], "]"}], "]"}], " ", "&&", " ", 
            RowBox[{"(", 
             RowBox[{"!", 
              RowBox[{"HasPath", "[", 
               RowBox[{"[", 
                RowBox[{"k1", ",", "k2"}], "]"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"InMaximal", "[", 
             RowBox[{"[", "k1", "]"}], "]"}], " ", "=", " ", "False"}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "InMaximal"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"a55c5555-7ef5-4559-bb39-4402f6a8070b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximalSet", "[", 
   RowBox[{"ballots_", ",", "type_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cands", ",", "prefmat", ",", "rels", ",", "inmax"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cands", " ", "=", " ", 
      RowBox[{"GetCandidates", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prefmat", " ", "=", " ", 
      RowBox[{"CondorcetMatrix", "[", "ballots", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rels", " ", "=", " ", 
      RowBox[{"PrefMatRelations", "[", 
       RowBox[{"prefmat", ",", " ", "type"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inmax", " ", "=", " ", 
      RowBox[{"FloydWarshallMaximal", "[", "rels", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Pick", "[", 
      RowBox[{"cands", ",", "inmax"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"8d879cf1-4abe-4719-a02d-16175b974a08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximalSetSequence", "[", 
   RowBox[{"ballots_", ",", "type_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newballots", ",", "maxsets", ",", "maxset"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newballots", " ", "=", " ", "ballots"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxsets", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"maxset", " ", "=", " ", 
         RowBox[{"MaximalSet", "[", 
          RowBox[{"newballots", ",", "type"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "maxset", "]"}], " ", "\[Equal]", " ", 
           "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"maxsets", ",", "maxset"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newballots", " ", "=", " ", 
         RowBox[{"RemoveCandidates", "[", 
          RowBox[{"newballots", ",", "maxset"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "maxsets"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"34464b6f-7d0a-4baa-883e-a09b4f382f44"]
}, Closed]],

Cell[CellGroupData[{

Cell["Alternate Algorithms", "Subsection",ExpressionUUID->"722f155d-4543-49ba-ab8a-319dc4f3136b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "My", " ", "original", " ", "version", " ", "of", " ", "permcycles"}], ",",
    " ", 
   RowBox[{
   "for", " ", "finding", " ", "the", " ", "cycles", " ", "of", " ", "a", " ",
     "permutation"}]}], " ", "*)"}]], "Input",ExpressionUUID->"1b7a9e13-23d3-\
4c48-a4c8-409ec715602b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"permcyclesorig", "[", "perm_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "i", ",", "avail", ",", 
      RowBox[{"cycles", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", "cycle", ",", "cyclebegin", ",", 
      "nextindex"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "perm", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"avail", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"True", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"avail", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Start", " ", "a", " ", "cycle"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"cyclebegin", " ", "=", " ", "i"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cycle", " ", "=", " ", 
         RowBox[{"{", "cyclebegin", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"avail", "[", 
          RowBox[{"[", "cyclebegin", "]"}], "]"}], " ", "=", " ", "False"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nextindex", " ", "=", " ", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Find", " ", "the", " ", "next", " ", "element", " ", "of", " ", 
           "a", " ", "cycle"}], ",", " ", 
          RowBox[{
          "until", " ", "one", " ", "comes", " ", "to", " ", "the", " ", 
           "first", " ", "element"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nextindex", " ", "=", " ", 
            RowBox[{"perm", "[", 
             RowBox[{"[", "nextindex", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nextindex", " ", "\[Equal]", " ", "cyclebegin"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cycle", ",", "nextindex"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"avail", "[", 
             RowBox[{"[", "nextindex", "]"}], "]"}], " ", "=", " ", 
            "False"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Cycle", " ", "complete"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"cycles", ",", "cycle"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "cycles"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"8097be5c-ff46-4ba2-adb2-8ff044664d55"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "My", " ", "original", " ", "version", " ", "of", " ", "the", " ", 
    "cyclicity", " ", 
    RowBox[{"tester", ":", " ", 
     RowBox[{
     "it", " ", "uses", " ", "the", " ", "cyclicity", " ", "test", " ", "in", 
      " ", "http"}], ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"www", ".", "cs", ".", "hmc", ".", "edu"}], "/", 
          RowBox[{"~", "keller"}]}], "/", "courses"}], "/", "cs60"}], "/", 
       "s98"}], "/", "examples"}], "/", "acyclic"}], "/"}]}], " ", 
  "*)"}]], "Input",ExpressionUUID->"e6621923-36bf-4f66-ab69-e3e6acd7415b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsAcyclicOrig", "[", "blext_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "blxtnew", ",", "indices", ",", "ix", ",", "numleft", ",", "numright", 
      ",", " ", "bdx", ",", " ", "rmleft", ",", " ", "rmright"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"What", " ", "indices", " ", "are", " ", 
      RowBox[{"present", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indices", " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "blext", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Nontrivial", " ", 
       RowBox[{"test", " ", "--"}], " ", "remove", " ", "all", " ", "the", 
       " ", "nodes", " ", "that", " ", "are", " ", "only", " ", "on", " ", 
       "left", " ", "sides", " ", "or", " ", "on", " ", "right", " ", 
       RowBox[{"sides", ".", " ", "Repeat"}], " ", "until", " ", "it", " ", 
       "is", " ", "no", " ", "longer", " ", "possible", " ", "to", " ", 
       "remove", " ", "any", " ", 
       RowBox[{"more", ".", " ", "Are"}], " ", "any", " ", 
       RowBox[{"left", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"blxtnew", " ", "=", " ", "blext"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "What", " ", "is", " ", "present", " ", "on", " ", "each", " ", 
         RowBox[{"side", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"numleft", "[", "ix", "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"numright", "[", "ix", "]"}], " ", "=", " ", "0"}]}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"ix", ",", "indices"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"numleft", "[", 
             RowBox[{"bdx", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "++"}], ";", " ", 
           RowBox[{
            RowBox[{"numright", "[", 
             RowBox[{"bdx", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "++"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"bdx", ",", "blxtnew"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "What", " ", "is", " ", "present", " ", "on", " ", "only", " ", 
          "one", " ", 
          RowBox[{"side", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rmleft", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", " ", 
        RowBox[{"rmright", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"numleft", "[", "ix", "]"}], ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"numright", "[", "ix", "]"}], "\[Equal]", "0"}]}], ",",
              " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"rmleft", ",", "ix"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"numleft", "[", "ix", "]"}], "\[Equal]", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"numright", "[", "ix", "]"}], ">", "0"}]}], ",", " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"rmright", ",", "ix"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ix", ",", "indices"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Can", " ", "one", " ", "go", " ", "any", " ", 
          RowBox[{"further", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "rmleft", "]"}], " ", "+", " ", 
            RowBox[{"Length", "[", "rmright", "]"}]}], " ", "\[Equal]", " ", 
           "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Remove", "!"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"blxtnew", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"blxtnew", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"rmleft", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], " ", "&&",
              " ", 
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"rmright", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], "&"}]}],
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Length", "[", "blxtnew", "]"}], " ", "\[Equal]", " ", 
      "0"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"835a5b38-a550-47aa-8b8e-e043900c0ca3"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Section",ExpressionUUID->"1932c0bc-a1de-4e0a-b25f-5d3ad11329dd"],

Cell[CellGroupData[{

Cell["Sample Ballots", "Subsection",ExpressionUUID->"8e1edd78-06ca-4f78-9b3f-2ec059f675d6"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Edge", " ", "cases"}], " ", "*)"}]], "Input",ExpressionUUID->\
"a6b9bd82-92a4-4976-aebe-979dacec4f2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<Zero\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",ExpressionUUID->"3995b87c-ccb1-4770-\
a570-b53519b9ece8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<One\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"{", "\"\<The Dear Leader\>\"", "}"}]}], "}"}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"decc9c31-d24a-46ab-ac74-c0c3a54e41cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<Two\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T Dee\>\"", ",", "\"\<T Dum\>\""}], "}"}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T Dum\>\"", ",", "\"\<T Dee\>\""}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",ExpressionUUID->"71f65b3a-727d-4867-a65d-\
5c0331ea0955"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"The", " ", "beer", " ", "and", " ", "distilled"}], "-", 
    RowBox[{"spirits", " ", "examples", " ", "are", " ", "from", " ", 
     RowBox[{"http", ":"}]}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"web", ".", "math", ".", "princeton", ".", "edu"}], "/", 
      "math_alive"}], "/", "Voting"}], "/", 
    RowBox[{"Lab1", ".", "shtml"}]}]}], " ", "*)"}]], "Input",ExpressionUUID->\
"813cadb7-1883-4f6c-83e0-5cd8661995f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<Beer\>\"", "]"}], " ", "=", " ", 
   RowBox[{"MakeBallotsFromCandNums", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Killians\>\"", ",", "\"\<Molson\>\"", ",", "\"\<Samuel Adams\>\"",
         ",", "\"\<Guinness\>\"", ",", "\"\<Meister Brau\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"18", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "1", ",", "2", ",", "4", ",", "3"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5", ",", "3", ",", "4", ",", "2"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "5", ",", "4", ",", "1", ",", "3"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "1", ",", "2", ",", "3"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "5", ",", "3", ",", "4", ",", "1"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "3", ",", "2", ",", "1"}], "}"}]}], 
         "}"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"30aa20b3-fe3f-422c-9114-77270f1e31b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<Distilled\>\"", "]"}], " ", "=", " ", 
   RowBox[{"MakeBallotsFromCandNums", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Absolut\>\"", ",", "\"\<Jim Beam\>\"", ",", "\"\<Jose Cuervo\>\"",
         ",", "\"\<Jack Daniels\>\"", ",", "\"\<So. Comfort\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "2", ",", "1", ",", "3", ",", "4"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "2", ",", "3", ",", "1", ",", "4"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "2", ",", "3", ",", "4", ",", "1"}], "}"}]}], 
         "}"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"0d8d15f7-2351-42f7-a3eb-d6559a91d63b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Several", " ", "Wikipedia", " ", "articles", " ", "use", " ", "these", " ",
    "ones"}], " ", "*)"}]], "Input",ExpressionUUID->"60b9a559-5466-4f56-b10d-\
be5acad9f7c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<TN Capital\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.42", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Memphis\>\"", ",", "\"\<Nashville\>\"", ",", 
         "\"\<Chattanooga\>\"", ",", "\"\<Knoxville\>\""}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.26", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Nashville\>\"", ",", "\"\<Chattanooga\>\"", ",", 
         "\"\<Knoxville\>\"", ",", "\"\<Memphis\>\""}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Chattanooga\>\"", ",", "\"\<Knoxville\>\"", ",", 
         "\"\<Nashville\>\"", ",", "\"\<Memphis\>\""}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.17", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Knoxville\>\"", ",", "\"\<Chattanooga\>\"", ",", 
         "\"\<Nashville\>\"", ",", "\"\<Memphis\>\""}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",ExpressionUUID->"1cb32300-b848-45db-b8c4-\
54121e6f8845"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<ABCDS\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"25", ",", 
       RowBox[{"{", "\"\<Andrea\>\"", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"34", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Carter\>\"", ",", "\"\<Brad\>\"", ",", "\"\<Delilah\>\""}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Brad\>\"", ",", "\"\<Delilah\>\""}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Delilah\>\"", ",", "\"\<Brad\>\""}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Delilah\>\"", ",", "\"\<Scott\>\""}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"21", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Scott\>\"", ",", "\"\<Delilah\>\""}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",ExpressionUUID->"b7554dc8-6018-46ab-bcf9-\
62dd29e440f9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"My", " ", 
   RowBox[{"one", ":", " ", 
    RowBox[{"ice", "-", 
     RowBox[{"cream", " ", "flavors"}]}]}]}], " ", "*)"}]], "Input",Expression\
UUID->"09f12334-cc5c-42b7-ac08-cf1acd1c2111"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SampleBallots", "[", "\"\<ICF\>\"", "]"}], " ", "=", " ", 
   RowBox[{"MakeWeighted", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Vanilla\>\"", ",", "\"\<Neapolitan\>\"", ",", "\"\<Chocolate\>\"",
         ",", "\"\<Cookie Dough\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Rocky Road\>\"", ",", "\"\<Mint CC\>\"", ",", "\"\<Chocolate\>\"",
         ",", "\"\<Vanilla\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Strawberry\>\"", ",", "\"\<Cherry\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Cookie Dough\>\"", ",", "\"\<Chocolate\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Cherry\>\"", ",", "\"\<Mint CC\>\"", ",", "\"\<Rocky Road\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Chocolate\>\"", ",", "\"\<Strawberry\>\"", ",", "\"\<Vanilla\>\"",
         ",", "\"\<Neapolitan\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Vanilla\>\"", ",", "\"\<Cookie Dough\>\"", ",", 
        "\"\<Rocky Road\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Cherry\>\"", ",", "\"\<Strawberry\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Neapolitan\>\"", ",", "\"\<Rocky Road\>\"", ",", 
        "\"\<Mint CC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Cherry\>\"", ",", "\"\<Vanilla\>\"", ",", "\"\<Strawberry\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Chocolate\>\"", ",", "\"\<Rocky Road\>\"", ",", 
        "\"\<Mint CC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Chocolate\>\"", ",", "\"\<Vanilla\>\"", ",", 
        "\"\<Strawberry\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Cherry\>\"", ",", "\"\<Mint CC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Strawberry\>\"", ",", "\"\<Mint CC\>\""}], "}"}]}], "}"}],
     "]"}]}], ";"}]], "Input",ExpressionUUID->"ff5484ce-0a93-41ab-bd0a-\
6182f6b2edab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SampleBallotNames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Zero\>\"", ",", "\"\<One\>\"", ",", "\"\<Two\>\"", ",", 
     "\"\<Beer\>\"", ",", "\"\<Distilled\>\"", ",", "\"\<TN Capital\>\"", 
     ",", "\"\<ABCDS\>\"", ",", "\"\<ICF\>\""}], "}"}]}], ";"}]], "Input",Expr\
essionUUID->"7df6e132-b9e7-4e45-91f3-51deeef50e90"]
}, Closed]],

Cell[CellGroupData[{

Cell["One Algorithm for All Ballots", "Subsection",ExpressionUUID->"627ef897-d1cd-415c-98c8-d7d286b6a19b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoAllSBs", "[", "f_", "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"name", ",", 
      RowBox[{"f", "[", 
       RowBox[{"SampleBallots", "[", "name", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"name", ",", "SampleBallotNames"}], "}"}]}], "]"}]}]], "Input",Ex\
pressionUUID->"6230a883-4434-4976-8797-aaf25f944034"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShortBallots", "[", "maxlen_", "]"}], " ", ":=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{"SampleBallotNames", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"GetCandidates", "[", 
        RowBox[{"SampleBallots", "[", "#", "]"}], "]"}], "]"}], 
      "\[LessEqual]", "maxlen"}], "&"}]}], "]"}]}]], "Input",ExpressionUUID->\
"bd4941a7-4e79-4ed8-bbd2-5cf83d58d6de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoShortSBs", "[", 
   RowBox[{"f_", ",", "maxlen_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"name", ",", 
      RowBox[{"f", "[", 
       RowBox[{"SampleBallots", "[", "name", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"name", ",", 
      RowBox[{"ShortBallots", "[", "maxlen", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"d2af5787-efa8-4236-ad57-dd6acb367466"],

Cell[BoxData[
 RowBox[{"DoShortSBs", "[", 
  RowBox[{"Dodgson", ",", "5"}], "]"}]], "Input",ExpressionUUID->"ad5fea0e-\
9d1f-4ab4-9db4-db8232f67772"],

Cell[BoxData[
 RowBox[{"DoAllSBs", "[", "MaximalLotteries", "]"}]], "Input",ExpressionUUID->"2b8baa7c-60d2-4170-a1e5-2bf60b6abefc"]
}, Closed]],

Cell[CellGroupData[{

Cell["All Algorithms for One Ballot", "Subsection",ExpressionUUID->"a4482293-7e5f-4b2b-8d77-b3416de6e1bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllVoteAlgs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Total Count\>\"", ",", " ", "TotalCount"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<All Votes\>\"", ",", " ", "AllVotes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Top One\>\"", ",", " ", "TopOne"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Top Number List\>\"", ",", " ", "TopNumList"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Minus Bottom\>\"", ",", " ", "MinusBottom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Borda\>\"", ",", " ", "Borda"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Modified Borda\>\"", ",", " ", "ModBorda"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Cumulative Borda\>\"", ",", " ", "CumulBorda"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Majority Judgment\>\"", ",", "MajorityJudgment"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Top-Two Runoff\>\"", ",", " ", "TopTwoRunoff"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Sequential Runoff\>\"", ",", " ", "SequentialRunoff"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<STV: 2 Seats\>\"", ",", " ", 
       RowBox[{
        RowBox[{"SingleTransferableVote", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<STV: 3 Seats\>\"", ",", " ", 
       RowBox[{
        RowBox[{"SingleTransferableVote", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<CPO STV: 1 Seat\>\"", ",", 
       RowBox[{
        RowBox[{"CPOSTVSchulze", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<CPO STV: 2 Seats\>\"", ",", 
       RowBox[{
        RowBox[{"CPOSTVSchulze", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<CPO STV: 3 Seats\>\"", ",", 
       RowBox[{
        RowBox[{"CPOSTVSchulze", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Condorcet Winner\>\"", ",", "CondorcetWinner"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Schulze Beatpath\>\"", ",", "Schulze"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Copeland\>\"", ",", " ", "Copeland"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Minimax Winning-Votes\>\"", ",", 
       RowBox[{
        RowBox[{"Minimax", "[", 
         RowBox[{"#", ",", "\"\<wins\>\""}], "]"}], "&"}]}], "}"}], ",", " ", 
     
     RowBox[{"{", 
      RowBox[{"\"\<Minimax Margins\>\"", ",", 
       RowBox[{
        RowBox[{"Minimax", "[", 
         RowBox[{"#", ",", "\"\<marg\>\""}], "]"}], "&"}]}], "}"}], ",", " ", 
     
     RowBox[{"{", 
      RowBox[{"\"\<Minimax Pairwise-Opposition\>\"", ",", 
       RowBox[{
        RowBox[{"Minimax", "[", 
         RowBox[{"#", ",", "\"\<oppo\>\""}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Kemeny-Young\>\"", ",", " ", "KemenyYoung"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Dodgson\>\"", ",", "Dodgson"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Tideman Ranked Pairs\>\"", ",", "RankedPairs"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Maximal Lotteries\>\"", ",", "MaximalLotteries"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Schwartz Maximal Set\>\"", ",", 
       RowBox[{
        RowBox[{"MaximalSet", "[", 
         RowBox[{"#", ",", "\"\<Schwartz\>\""}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Smith Maximal Set\>\"", ",", 
       RowBox[{
        RowBox[{"MaximalSet", "[", 
         RowBox[{"#", ",", "\"\<Smith\>\""}], "]"}], "&"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",ExpressionUUID->"40ef7d54-8713-496d-bb11-6fd823b3a9b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorialAlgNames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Kemeny-Young\>\"", ",", " ", "\"\<Dodgson\>\""}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"593cf986-a237-4573-b1b7-5088f00ad714"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "With", " ", "an", " ", "option", " ", "\"\<DoFactorial\>\"", " ", "to", 
    " ", "avoid", " ", "doing", " ", "factorial"}], "-", 
   RowBox[{"time", " ", "algorithms", " ", "if", " ", "desired"}]}], " ", 
  "*)"}]], "Input",ExpressionUUID->"0f124c1f-16b5-4d6e-902f-dc9614cd0041"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoAllVoteAlgs", "[", 
   RowBox[{"ballotbox_", ",", "DoFactorial_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nmag", ",", "name", ",", "alg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"name", ",", "alg"}], "}"}], " ", "=", " ", "nmag"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"name", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DoFactorial", " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"FactorialAlgNames", ",", "name"}], "]"}]}], ")"}]}], 
           ",", " ", 
           RowBox[{"alg", "[", "ballotbox", "]"}], ",", "Null"}], "]"}]}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"nmag", ",", "AllVoteAlgs"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"1121fd76-8b38-\
43cf-aa8d-a80e04cddcf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoAllVoteAlgs", "[", 
   RowBox[{
    RowBox[{"SampleBallots", "[", "\"\<TN Capital\>\"", "]"}], ",", "True"}], 
   "]"}], " ", "//", " ", "TableForm"}]], "Input",ExpressionUUID->"92e32c1f-\
f2f4-48f7-934c-e41fbf40086e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoAllVoteAlgs", "[", 
   RowBox[{
    RowBox[{"SampleBallots", "[", "\"\<ICF\>\"", "]"}], ",", "False"}], "]"}],
   " ", "//", " ", "TableForm"}]], "Input",ExpressionUUID->"e15ce062-22ec-\
4ebb-a01e-ce0974e727c7"]
}, Closed]]
}, Closed]]
},
WindowSize->{810, 695},
WindowMargins->{{Automatic, 45}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4669, 100, 1550, "Text", "ExpressionUUID" -> \
"64293c62-2ca8-49b6-a810-e2f63403724e"],
Cell[CellGroupData[{
Cell[5252, 124, 84, 0, 64, "Section", "ExpressionUUID" -> \
"3d6fca68-9461-4201-9be8-3332935eee5e"],
Cell[CellGroupData[{
Cell[5361, 128, 82, 0, 44, "Subsection", "ExpressionUUID" -> \
"35b05ba1-a8c4-466b-9a55-a1370866193e"],
Cell[5446, 130, 325, 10, 32, "Input", "ExpressionUUID" -> \
"eba25053-4493-4992-9a24-2390118e4cce"],
Cell[5774, 142, 1672, 43, 222, "Input", "ExpressionUUID" -> \
"55ae3829-c316-4f75-b8fb-64adba884990"],
Cell[7449, 187, 355, 10, 32, "Input", "ExpressionUUID" -> \
"de13a307-a609-404a-805f-920ae45f1086"],
Cell[7807, 199, 379, 10, 32, "Input", "ExpressionUUID" -> \
"aa387e86-13ab-44bb-aab2-45430209335f"],
Cell[8189, 211, 453, 13, 32, "Input", "ExpressionUUID" -> \
"4814d37b-b88b-480f-ba03-e925e9ca52ff"],
Cell[8645, 226, 526, 11, 75, "Input", "ExpressionUUID" -> \
"cb971d4a-3f1e-450d-b457-3f7e87f7b7c2"],
Cell[9174, 239, 1180, 30, 159, "Input", "ExpressionUUID" -> \
"cd543992-2901-46b9-a225-2c6ad00a6817"],
Cell[10357, 271, 281, 7, 32, "Input", "ExpressionUUID" -> \
"4305e25f-4a0c-4969-a9fd-8fc43b20390d"],
Cell[10641, 280, 381, 10, 32, "Input", "ExpressionUUID" -> \
"2545e4fc-2dc5-4dac-9066-b56f2395af57"],
Cell[11025, 292, 409, 11, 32, "Input", "ExpressionUUID" -> \
"1f28f70e-06c1-494b-a462-1f72e00c182c"],
Cell[11437, 305, 638, 15, 117, "Input", "ExpressionUUID" -> \
"0bd4623c-f695-468b-8817-c6357895b093"],
Cell[12078, 322, 1790, 51, 180, "Input", "ExpressionUUID" -> \
"42e05fca-add4-4467-a8bd-563498e2e203"]
}, Closed]],
Cell[CellGroupData[{
Cell[13905, 378, 96, 0, 36, "Subsection", "ExpressionUUID" -> \
"2eee5617-0da6-4be9-b6fd-aff3175d4457"],
Cell[14004, 380, 314, 8, 32, "Input", "ExpressionUUID" -> \
"3aa66cbc-ad12-4795-a1fd-e8bdf0d3f698"],
Cell[14321, 390, 407, 11, 32, "Input", "ExpressionUUID" -> \
"6b1f814b-cb80-4d47-abc9-862ca5353b09"],
Cell[14731, 403, 242, 5, 32, "Input", "ExpressionUUID" -> \
"d47983e3-daa4-42f5-87c1-7bbcf1c654f6"],
Cell[14976, 410, 466, 12, 54, "Input", "ExpressionUUID" -> \
"b0389a42-af81-4e8e-9ce9-7924f55fdc0d"],
Cell[15445, 424, 238, 5, 32, "Input", "ExpressionUUID" -> \
"94c937cd-ebf9-4e31-89e6-b0df25137521"],
Cell[15686, 431, 1349, 35, 180, "Input", "ExpressionUUID" -> \
"e5be9a85-3e40-4463-816f-71351dfdce98"],
Cell[17038, 468, 248, 5, 32, "Input", "ExpressionUUID" -> \
"568831d6-c05c-49b9-a231-a04e6b04bb5a"],
Cell[17289, 475, 281, 8, 32, "Input", "ExpressionUUID" -> \
"48a792f7-2e77-488a-a14f-2e0c2ef1b710"],
Cell[17573, 485, 889, 26, 96, "Input", "ExpressionUUID" -> \
"dc186a48-ed70-46fc-89c7-0cfbdd54309c"],
Cell[18465, 513, 385, 10, 32, "Input", "ExpressionUUID" -> \
"07f9aa40-d7df-47cc-b3a2-accd474acf26"],
Cell[18853, 525, 687, 18, 96, "Input", "ExpressionUUID" -> \
"4a45d89f-9753-4fd2-8d2b-604b3c3b9bbf"]
}, Closed]],
Cell[CellGroupData[{
Cell[19577, 548, 90, 0, 36, "Subsection", "ExpressionUUID" -> \
"1c0d6299-0f43-46c6-9b2f-3c420b9f266c"],
Cell[19670, 550, 278, 8, 32, "Input", "ExpressionUUID" -> \
"9a6bcaf4-e542-4a02-8ff1-5d021651d429"],
Cell[19951, 560, 1039, 27, 117, "Input", "ExpressionUUID" -> \
"ec1372ff-bfd5-42d8-bfbb-82f2d3ccc623"],
Cell[20993, 589, 236, 5, 32, "Input", "ExpressionUUID" -> \
"3c03649e-db5e-4d24-b9db-098a0a6667e1"],
Cell[21232, 596, 1042, 27, 117, "Input", "ExpressionUUID" -> \
"e0619d84-6318-41dc-9652-aa629cbf3077"],
Cell[22277, 625, 242, 5, 32, "Input", "ExpressionUUID" -> \
"81a53712-1f75-4bc9-97f1-aa12ef188906"],
Cell[22522, 632, 284, 8, 32, "Input", "ExpressionUUID" -> \
"8a43483f-520c-4891-bc15-0dfb5b634065"],
Cell[22809, 642, 1920, 51, 180, "Input", "ExpressionUUID" -> \
"4f2bd8ea-dedf-47ff-b5e0-635b1a66c3e8"],
Cell[24732, 695, 246, 5, 32, "Input", "ExpressionUUID" -> \
"186d270e-7645-4c92-b10f-afea4af5c3b8"],
Cell[24981, 702, 285, 8, 32, "Input", "ExpressionUUID" -> \
"b993ad03-0ee3-4a79-aef2-09ed605b81e0"],
Cell[25269, 712, 250, 6, 32, "Input", "ExpressionUUID" -> \
"eccacd9e-6b3a-462b-9475-8045fbf83c48"],
Cell[25522, 720, 4377, 105, 516, "Input", "ExpressionUUID" -> \
"22c81edc-b37f-44d0-873b-6e9ba5d51b80"],
Cell[29902, 827, 3687, 95, 285, "Input", "ExpressionUUID" -> \
"f2bfdc3f-7836-4ada-b9be-af1c767a9f37"]
}, Closed]],
Cell[CellGroupData[{
Cell[33626, 927, 86, 0, 36, "Subsection", "ExpressionUUID" -> \
"a05f95c4-182c-4a51-b113-c2888bf076d8"],
Cell[33715, 929, 529, 16, 75, "Input", "ExpressionUUID" -> \
"7ee69943-d7db-4bc6-a406-fe2c0b470619"],
Cell[34247, 947, 3094, 75, 516, "Input", "ExpressionUUID" -> \
"4df8eba8-58c4-4bf9-9a1d-05603e622bf9"],
Cell[37344, 1024, 1481, 40, 201, "Input", "ExpressionUUID" -> \
"27a388de-c6c0-4467-b986-32e8975ecdd7"],
Cell[38828, 1066, 2190, 54, 285, "Input", "ExpressionUUID" -> \
"b214d216-eced-4b37-885d-7ad0eebe4366"],
Cell[41021, 1122, 313, 9, 32, "Input", "ExpressionUUID" -> \
"83886cdc-52fa-4bf8-9ff1-c970cc1c3467"],
Cell[41337, 1133, 6863, 162, 831, "Input", "ExpressionUUID" -> \
"c16908b9-a65c-4fe1-a69f-edce210716ee"],
Cell[48203, 1297, 477, 15, 32, "Input", "ExpressionUUID" -> \
"87012073-0eb3-4468-b4b1-a9e376349c3d"],
Cell[48683, 1314, 9091, 206, 1125, "Input", "ExpressionUUID" -> \
"ba4ace2f-8ea3-43f1-8ee2-8a4b8127c831"],
Cell[57777, 1522, 496, 11, 75, "Input", "ExpressionUUID" -> \
"ccd26623-5799-4170-8f12-dd8d4f1dc8c5"]
}, Closed]],
Cell[CellGroupData[{
Cell[58310, 1538, 92, 0, 36, "Subsection", "ExpressionUUID" -> \
"a630791f-103b-4140-9b89-ef73f1b36bfc"],
Cell[58405, 1540, 3362, 84, 369, "Input", "ExpressionUUID" -> \
"24c157ab-71bb-419c-a565-bc825bc326ec"],
Cell[61770, 1626, 317, 6, 54, "Input", "ExpressionUUID" -> \
"005f3640-e5bb-4907-98be-3b7e4b6718a4"],
Cell[62090, 1634, 776, 18, 117, "Input", "ExpressionUUID" -> \
"2eb649f4-4c9d-45ee-b06d-4c8bbcae3df3"],
Cell[62869, 1654, 368, 7, 54, "Input", "ExpressionUUID" -> \
"be30c2ac-4095-40e3-a934-84d36e6db85a"],
Cell[63240, 1663, 1129, 30, 117, "Input", "ExpressionUUID" -> \
"0dcc46fe-fd4c-432b-a8d9-ecce1a114f24"],
Cell[64372, 1695, 995, 21, 138, "Input", "ExpressionUUID" -> \
"4b618bf5-5bdf-451b-aca5-0e29f6ddc121"],
Cell[65370, 1718, 5101, 121, 621, "Input", "ExpressionUUID" -> \
"987c4fa7-181f-4e45-bab4-fc9e8374091d"],
Cell[70474, 1841, 225, 5, 32, "Input", "ExpressionUUID" -> \
"645226d3-43b5-4ccb-8647-a975282ff2ed"],
Cell[70702, 1848, 236, 5, 32, "Input", "ExpressionUUID" -> \
"e0e30fed-c0a1-4d30-8279-ef7300c10002"],
Cell[70941, 1855, 181, 4, 32, "Input", "ExpressionUUID" -> \
"58bd436c-5a24-4ce8-8629-e2be516112ce"],
Cell[71125, 1861, 630, 16, 96, "Input", "ExpressionUUID" -> \
"0cdd3792-45d8-4f67-a27b-38b424616a35"]
}, Closed]],
Cell[CellGroupData[{
Cell[71792, 1882, 94, 0, 36, "Subsection", "ExpressionUUID" -> \
"b6242a00-224a-45d8-a97d-89676c5703c4"],
Cell[71889, 1884, 2044, 50, 348, "Input", "ExpressionUUID" -> \
"d85df959-9e6c-4561-9fa0-343e3af02fda"],
Cell[73936, 1936, 941, 23, 117, "Input", "ExpressionUUID" -> \
"acc0908e-34fc-41a0-bc8d-4c19bc6e6fd0"],
Cell[74880, 1961, 355, 10, 32, "Input", "ExpressionUUID" -> \
"ca009228-ae37-481d-b4f2-baf9aa626f94"],
Cell[75238, 1973, 910, 22, 117, "Input", "ExpressionUUID" -> \
"c13fcbb4-6910-4fc7-8e6d-63be5b0531c0"],
Cell[76151, 1997, 3978, 99, 558, "Input", "ExpressionUUID" -> \
"0e123b7e-7c83-4928-8de4-6fcdbe66d62f"],
Cell[80132, 2098, 248, 5, 32, "Input", "ExpressionUUID" -> \
"f0156584-b2c1-4f95-a880-af2501482d48"],
Cell[80383, 2105, 1008, 26, 117, "Input", "ExpressionUUID" -> \
"96469c98-d8da-4898-aae7-7f9a7be6c999"],
Cell[81394, 2133, 407, 11, 32, "Input", "ExpressionUUID" -> \
"c3397b38-9993-4c9d-9dda-0824985511ef"],
Cell[81804, 2146, 1779, 47, 222, "Input", "ExpressionUUID" -> \
"d5f6fc63-d4bd-4bbd-9462-bbd3a24d6dbd"],
Cell[83586, 2195, 250, 5, 32, "Input", "ExpressionUUID" -> \
"43c783e9-14c7-449c-91ec-1cb2029e4042"],
Cell[83839, 2202, 697, 17, 75, "Input", "ExpressionUUID" -> \
"1b926925-cdec-4091-9b22-978b8d2d2386"],
Cell[84539, 2221, 3185, 74, 411, "Input", "ExpressionUUID" -> \
"d1483377-a035-4c05-88b1-e89b422f7a4f"],
Cell[87727, 2297, 364, 9, 32, "Input", "ExpressionUUID" -> \
"ff8c7d70-3aa2-4f21-82b5-a36d9eb92ee2"],
Cell[88094, 2308, 333, 9, 32, "Input", "ExpressionUUID" -> \
"1176fab1-2f7d-4a57-aee8-87ccb9bf8699"],
Cell[88430, 2319, 2135, 56, 327, "Input", "ExpressionUUID" -> \
"ad9b682a-8ab0-448c-b186-40d6edc1298e"],
Cell[90568, 2377, 990, 24, 138, "Input", "ExpressionUUID" -> \
"635d8cd0-74b1-4c40-9ec9-600a84f80816"],
Cell[91561, 2403, 256, 5, 32, "Input", "ExpressionUUID" -> \
"aa2a8988-d1d3-4331-aa8e-95263094cf08"],
Cell[91820, 2410, 320, 9, 32, "Input", "ExpressionUUID" -> \
"77e3f2bc-261b-443e-a411-2a7881d3a8a6"],
Cell[92143, 2421, 1210, 35, 117, "Input", "ExpressionUUID" -> \
"78cdb117-2978-4a31-995a-b7784b614260"],
Cell[93356, 2458, 1930, 47, 243, "Input", "ExpressionUUID" -> \
"eee83048-a9af-4e50-bc71-3ff886e46590"],
Cell[95289, 2507, 1590, 42, 159, "Input", "ExpressionUUID" -> \
"010bb387-8eef-4f6b-9973-9657abe035c7"],
Cell[96882, 2551, 507, 14, 54, "Input", "ExpressionUUID" -> \
"9db7daff-d46c-43b5-b7a3-612cc05335f3"],
Cell[97392, 2567, 5086, 125, 558, "Input", "ExpressionUUID" -> \
"16e58811-ef71-4869-a117-edf2d74c4229"],
Cell[102481, 2694, 256, 5, 32, "Input", "ExpressionUUID" -> \
"c24af58f-5fc1-4427-97e7-ed4bc04b5392"],
Cell[102740, 2701, 921, 27, 75, "Input", "ExpressionUUID" -> \
"a649b60f-5873-4b28-83b8-d62f4e842da2"],
Cell[103664, 2730, 2228, 60, 201, "Input", "ExpressionUUID" -> \
"13b1b6a1-42d9-4207-a508-9721e3f1d6b6"],
Cell[105895, 2792, 262, 5, 32, "Input", "ExpressionUUID" -> \
"0cdca87b-62c0-427f-a854-a7ddea69ac48"]
}, Closed]],
Cell[CellGroupData[{
Cell[106194, 2802, 89, 0, 36, "Subsection", "ExpressionUUID" -> \
"955771f7-607f-437c-a2ef-4f62e5a3f305"],
Cell[106286, 2804, 669, 17, 75, "Input", "ExpressionUUID" -> \
"60e403dc-751e-47e9-bf4b-773dd1235ba7"],
Cell[106958, 2823, 1689, 41, 222, "Input", "ExpressionUUID" -> \
"e3bdd20a-9c8f-4827-995c-0bf2cb6a540f"],
Cell[108650, 2866, 4242, 107, 474, "Input", "ExpressionUUID" -> \
"a55c5555-7ef5-4559-bb39-4402f6a8070b"],
Cell[112895, 2975, 1079, 25, 201, "Input", "ExpressionUUID" -> \
"8d879cf1-4abe-4719-a02d-16175b974a08"],
Cell[113977, 3002, 1497, 35, 285, "Input", "ExpressionUUID" -> \
"34464b6f-7d0a-4baa-883e-a09b4f382f44"]
}, Closed]],
Cell[CellGroupData[{
Cell[115511, 3042, 97, 0, 36, "Subsection", "ExpressionUUID" -> \
"722f155d-4543-49ba-ab8a-319dc4f3136b"],
Cell[115611, 3044, 341, 9, 54, "Input", "ExpressionUUID" -> \
"1b7a9e13-23d3-4c48-a4c8-409ec715602b"],
Cell[115955, 3055, 3176, 73, 474, "Input", "ExpressionUUID" -> \
"8097be5c-ff46-4ba2-adb2-8ff044664d55"],
Cell[119134, 3130, 706, 20, 54, "Input", "ExpressionUUID" -> \
"e6621923-36bf-4f66-ab69-e3e6acd7415b"],
Cell[119843, 3152, 5689, 138, 600, "Input", "ExpressionUUID" -> \
"835a5b38-a550-47aa-8b8e-e043900c0ca3"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[125581, 3296, 82, 0, 50, "Section", "ExpressionUUID" -> \
"1932c0bc-a1de-4e0a-b25f-5d3ad11329dd"],
Cell[CellGroupData[{
Cell[125688, 3300, 91, 0, 44, "Subsection", "ExpressionUUID" -> \
"8e1edd78-06ca-4f78-9b3f-2ec059f675d6"],
Cell[125782, 3302, 148, 3, 32, "Input", "ExpressionUUID" -> \
"a6b9bd82-92a4-4976-aebe-979dacec4f2a"],
Cell[125933, 3307, 205, 5, 32, "Input", "ExpressionUUID" -> \
"3995b87c-ccb1-4770-a570-b53519b9ece8"],
Cell[126141, 3314, 310, 8, 32, "Input", "ExpressionUUID" -> \
"decc9c31-d24a-46ab-ac74-c0c3a54e41cc"],
Cell[126454, 3324, 513, 16, 32, "Input", "ExpressionUUID" -> \
"71f65b3a-727d-4867-a65d-5c0331ea0955"],
Cell[126970, 3342, 513, 13, 54, "Input", "ExpressionUUID" -> \
"813cadb7-1883-4f6c-83e0-5cd8661995f9"],
Cell[127486, 3357, 1541, 43, 117, "Input", "ExpressionUUID" -> \
"30aa20b3-fe3f-422c-9114-77270f1e31b9"],
Cell[129030, 3402, 1381, 39, 117, "Input", "ExpressionUUID" -> \
"0d8d15f7-2351-42f7-a3eb-d6559a91d63b"],
Cell[130414, 3443, 218, 5, 32, "Input", "ExpressionUUID" -> \
"60b9a559-5466-4f56-b10d-be5acad9f7c8"],
Cell[130635, 3450, 1136, 32, 117, "Input", "ExpressionUUID" -> \
"1cb32300-b848-45db-b8c4-54121e6f8845"],
Cell[131774, 3484, 1102, 33, 75, "Input", "ExpressionUUID" -> \
"b7554dc8-6018-46ab-bcf9-62dd29e440f9"],
Cell[132879, 3519, 236, 6, 32, "Input", "ExpressionUUID" -> \
"09f12334-cc5c-42b7-ac08-cf1acd1c2111"],
Cell[133118, 3527, 2066, 54, 201, "Input", "ExpressionUUID" -> \
"ff5484ce-0a93-41ab-bd0a-6182f6b2edab"],
Cell[135187, 3583, 373, 8, 54, "Input", "ExpressionUUID" -> \
"7df6e132-b9e7-4e45-91f3-51deeef50e90"]
}, Closed]],
Cell[CellGroupData[{
Cell[135597, 3596, 106, 0, 36, "Subsection", "ExpressionUUID" -> \
"627ef897-d1cd-415c-98c8-d7d286b6a19b"],
Cell[135706, 3598, 413, 11, 32, "Input", "ExpressionUUID" -> \
"6230a883-4434-4976-8797-aaf25f944034"],
Cell[136122, 3611, 432, 11, 54, "Input", "ExpressionUUID" -> \
"bd4941a7-4e79-4ed8-bbd2-5cf83d58d6de"],
Cell[136557, 3624, 479, 13, 54, "Input", "ExpressionUUID" -> \
"d2af5787-efa8-4236-ad57-dd6acb367466"],
Cell[137039, 3639, 149, 3, 32, "Input", "ExpressionUUID" -> \
"ad5fea0e-9d1f-4ab4-9db4-db8232f67772"],
Cell[137191, 3644, 131, 1, 32, "Input", "ExpressionUUID" -> \
"2b8baa7c-60d2-4170-a1e5-2bf60b6abefc"]
}, Closed]],
Cell[CellGroupData[{
Cell[137359, 3650, 106, 0, 36, "Subsection", "ExpressionUUID" -> \
"a4482293-7e5f-4b2b-8d77-b3416de6e1bb"],
Cell[137468, 3652, 3924, 101, 369, "Input", "ExpressionUUID" -> \
"40ef7d54-8713-496d-bb11-6fd823b3a9b2"],
Cell[141395, 3755, 238, 5, 32, "Input", "ExpressionUUID" -> \
"593cf986-a237-4573-b1b7-5088f00ad714"],
Cell[141636, 3762, 342, 7, 32, "Input", "ExpressionUUID" -> \
"0f124c1f-16b5-4d6e-902f-dc9614cd0041"],
Cell[141981, 3771, 1125, 31, 117, "Input", "ExpressionUUID" -> \
"1121fd76-8b38-43cf-aa8d-a80e04cddcf1"],
Cell[143109, 3804, 255, 6, 32, "Input", "ExpressionUUID" -> \
"92e32c1f-f2f4-48f7-934c-e41fbf40086e"],
Cell[143367, 3812, 248, 6, 32, "Input", "ExpressionUUID" -> \
"e15ce062-22ec-4ebb-a01e-ce0974e727c7"]
}, Closed]]
}, Closed]]
}
]
*)

